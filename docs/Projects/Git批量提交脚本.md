# Git äº¤äº’å¼æäº¤åŠ©æ‰‹ V2.6 - å®Œæ•´ä½¿ç”¨æ‰‹å†Œ

## å†™åœ¨æœ€å‰é¢  è¯·è¯¦ç»†é˜…è¯»

### è®¸å¯ä¸å£°æ˜

æœ¬è„šæœ¬ä¸ºå¼€æºå·¥å…·ï¼Œå¯è‡ªç”±ä¿®æ”¹å’Œåˆ†å‘ã€‚ä½¿ç”¨æ—¶è¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

- âœ… ä¸ªäººå’Œå•†ä¸šé¡¹ç›®å‡å¯å…è´¹ä½¿ç”¨
- âœ… å¯æ ¹æ®éœ€æ±‚è‡ªç”±ä¿®æ”¹
- âœ… å»ºè®®ä¿ç•™åŸä½œè€…ä¿¡æ¯
- âŒ ä¸æä¾›ä»»ä½•å½¢å¼çš„æ‹…ä¿
- âŒ ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…é£é™©

**æ³¨æ„ï¼ï¼ï¼å¦‚æœæ–°å»ºäº†é¡¹ç›®æ–‡ä»¶å¤¹ è¯¥è„šæœ¬ä¸æ”¯æŒä¸€é”®æäº¤ï¼Œéœ€è¦è‡ªè¡Œæ‰‹åŠ¨æ“ä½œ**

ç‚¹å‡»è·³è½¬åˆ° [é¡¹ç›®è„šæœ¬ç¨‹åºæºç ](#script-files)

ä¸æƒ³å¤åˆ¶ç²˜è´´ï¼Œæºç ä¸€æ¬¡æ€§ä¸‹è½½è·¯å¾„ [æˆ‘çš„Githubä»“åº“](https://github.com/moyan726/data-analytics-notes/tree/main/Data%20and%20original%20files/%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81-%20Git%20%E4%BA%A4%E4%BA%92%E5%BC%8F%E6%8F%90%E4%BA%A4%E5%8A%A9%E6%89%8B)

## ğŸ“š ç›®å½•

1. [ç®€ä»‹](#jianjie)
2. [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
3. [å®‰è£…ä¸é…ç½®](#å®‰è£…ä¸é…ç½®)
4. [å¿«é€Ÿä¸Šæ‰‹](#å¿«é€Ÿä¸Šæ‰‹)
5. [è¯¦ç»†åŠŸèƒ½è¯´æ˜](#è¯¦ç»†åŠŸèƒ½è¯´æ˜)
6. [é«˜çº§ç”¨æ³•](#é«˜çº§ç”¨æ³•)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
8. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
9. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ )
10. [é…ç½®å‚è€ƒ](#é…ç½®å‚è€ƒ)

------

<a id="jianjie"></a>

## ç®€ä»‹

### è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™æ˜¯ä¸€ä¸ª **PowerShell äº¤äº’å¼ Git æäº¤è„šæœ¬**ï¼Œä¸“é—¨è§£å†³ä»¥ä¸‹ç—›ç‚¹ï¼š

- âŒ å·¥ä½œåŒºæœ‰ 20+ ä¸ªæ–‡ä»¶æ”¹åŠ¨ï¼Œæƒ³åˆ†æ‰¹æäº¤ä½†æ“ä½œç¹ç
- âŒ æ‰‹åŠ¨ `git add` æ¯ä¸ªæ–‡ä»¶å®¹æ˜“å‡ºé”™
- âŒ æ€•è¯¯æäº¤æ•æ„Ÿæ–‡ä»¶ï¼ˆ`.env`ã€å¯†é’¥ç­‰ï¼‰
- âŒ æ€•æ¼æ‰æŸäº›æ–‡ä»¶æ²¡æäº¤
- âŒ ä¸ç¡®å®šå½“å‰ä»“åº“çŠ¶æ€æ˜¯å¦å®‰å…¨

### æ ¸å¿ƒåŠŸèƒ½

âœ… **åˆ†æ‰¹æäº¤** - ä»æ–‡ä»¶åˆ—è¡¨ä¸­æŒ‰ç¼–å·é€‰æ‹©ï¼Œä¸€æ¬¡æäº¤ä¸€ç»„
 âœ… **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨æ£€æŸ¥ä»“åº“çŠ¶æ€ã€è¯†åˆ«é£é™©
 âœ… **é—æ¼æé†’** - å®æ—¶ç»Ÿè®¡å·²æäº¤/å‰©ä½™æ–‡ä»¶æ•°
 âœ… **å®‰å…¨é˜²æŠ¤** - æ•æ„Ÿæ–‡ä»¶è­¦å‘Šã€å¤§æ–‡ä»¶æé†’ã€ä¸»åˆ†æ”¯ä¿æŠ¤
 âœ… **å¯è§†åŒ–å¼º** - å½©è‰²è¾“å‡ºã€çŠ¶æ€å›¾æ ‡ã€è¿›åº¦ç»Ÿè®¡
 âœ… **å®¹é”™æ€§å¥½** - ä¸­æ–‡è·¯å¾„ã€ç©ºæ ¼è·¯å¾„ã€ç‰¹æ®Šå­—ç¬¦å…¨æ”¯æŒ

------

<a id="ç³»ç»Ÿè¦æ±‚"></a>

## ç³»ç»Ÿè¦æ±‚

### å¿…éœ€æ¡ä»¶

| é¡¹ç›®       | è¦æ±‚                 | æ£€æŸ¥æ–¹æ³•                    |
| ---------- | -------------------- | --------------------------- |
| æ“ä½œç³»ç»Ÿ   | Windows 10/11        | -                           |
| PowerShell | 5.1 æˆ– 7.x           | `$PSVersionTable.PSVersion` |
| Git        | 2.20+                | `git --version`             |
| æƒé™       | æ‰§è¡Œç­–ç•¥å…è®¸è„šæœ¬è¿è¡Œ | è§ä¸‹æ–‡                      |

### æ¨èé…ç½®

- **ç»ˆç«¯**: Windows Terminalï¼ˆæ›´å¥½çš„ Unicode æ”¯æŒï¼‰
- **å­—ä½“**: æ”¯æŒ Emoji çš„ç­‰å®½å­—ä½“ï¼ˆå¦‚ Cascadia Codeï¼‰
- **ç¼–ç **: ç»ˆç«¯ç¼–ç è®¾ä¸º UTF-8

------



<a id="å®‰è£…ä¸é…ç½®"></a>

## å®‰è£…ä¸é…ç½®

### æ­¥éª¤ 1: ä¸‹è½½è„šæœ¬

å°†è„šæœ¬ä¿å­˜ä¸º `interactive-commit.ps1`ï¼š

```powershell
# ä¿å­˜åˆ°å¸¸ç”¨ä½ç½®ï¼Œä¾‹å¦‚
C:\Scripts\interactive-commit.ps1
# æˆ–é¡¹ç›®ç›®å½•
E:\MyProject\tools\interactive-commit.ps1
```

âš ï¸ **é‡è¦**: æ–‡ä»¶å¿…é¡»ä»¥ **UTF-8 with BOM** ç¼–ç ä¿å­˜ï¼Œå¦åˆ™ä¸­æ–‡ä¼šä¹±ç 

**å¦‚ä½•è®¾ç½®ç¼–ç ï¼Ÿ**

- VS Code: å³ä¸‹è§’ç‚¹å‡»ç¼–ç  â†’ é€‰æ‹© "UTF-8 with BOM" â†’ ä¿å­˜
- Notepad++: ç¼–ç  â†’ è½¬ä¸º UTF-8 BOM ç¼–ç 

### æ­¥éª¤ 2: è®¾ç½®æ‰§è¡Œç­–ç•¥

PowerShell é»˜è®¤ç¦æ­¢è¿è¡Œè„šæœ¬ï¼Œéœ€è¦ä¿®æ”¹ç­–ç•¥ï¼š

```powershell
# æ–¹æ¡ˆ 1: ä»…å½“å‰ç”¨æˆ·å…è®¸ï¼ˆæ¨èï¼‰
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# æ–¹æ¡ˆ 2: ä¸´æ—¶å…è®¸ï¼ˆä¸€æ¬¡æ€§ï¼‰
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process
```

éªŒè¯æ˜¯å¦ç”Ÿæ•ˆï¼š

```powershell
Get-ExecutionPolicy -List
```

### æ­¥éª¤ 3: é…ç½®è„šæœ¬å‚æ•°

æ‰“å¼€è„šæœ¬ï¼Œä¿®æ”¹é¡¶éƒ¨çš„ `$Config` å˜é‡ï¼š

```powershell
$Config = @{
    # æ˜¯å¦ä¿æŠ¤ä¸»åˆ†æ”¯ï¼ˆmain/masterï¼‰
    ProtectMainBranch    = $true
    
    # æ•æ„Ÿæ–‡ä»¶æ¨¡å¼ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰
    SensitivePatterns    = @(
        ".env",           # ç¯å¢ƒå˜é‡æ–‡ä»¶
        "*.key",          # å¯†é’¥æ–‡ä»¶
        "id_rsa",         # SSH ç§é’¥
        "secrets.*",      # secrets.yaml ç­‰
        "*credentials*",  # åŒ…å« credentials çš„æ–‡ä»¶
        "config.prod*"    # ç”Ÿäº§é…ç½®
    )
    
    # å¤§æ–‡ä»¶é˜ˆå€¼ï¼ˆMBï¼‰
    LargeFileThresholdMB = 50
    
    # å¤‡ç”¨ä»“åº“è·¯å¾„ï¼ˆå¯é€‰ï¼‰
    TargetRepoPath       = "E:\pycharm\MyWeb\data-analytics-notes"
}
```

### æ­¥éª¤ 4: æµ‹è¯•è¿è¡Œ

```powershell
# è¿›å…¥ä»»æ„ Git ä»“åº“
cd E:\MyProject

# è¿è¡Œè„šæœ¬
.\interactive-commit.ps1
```

------





<a id="å¿«é€Ÿä¸Šæ‰‹"></a>

## å¿«é€Ÿä¸Šæ‰‹

### åŸºç¡€å·¥ä½œæµ

```
1. è¿è¡Œè„šæœ¬
   â†“
2. ç¡®è®¤ä»“åº“ä¿¡æ¯ï¼ˆåˆ†æ”¯ã€æ–‡ä»¶æ•°ï¼‰
   â†“
3. ä»åˆ—è¡¨ä¸­é€‰æ‹©æ–‡ä»¶ï¼ˆè¾“å…¥ç¼–å·ï¼‰
   â†“
4. è¾“å…¥ Commit Message
   â†“
5. é‡å¤ 3-4 ç›´åˆ°æ–‡ä»¶å¤„ç†å®Œæ¯•
   â†“
6. è¾“å…¥ q è¿›å…¥æ¨é€é˜¶æ®µ
   â†“
7. ç¡®è®¤æ¨é€ â†’ å®Œæˆï¼
```

### ç¤ºä¾‹åœºæ™¯

å‡è®¾ä½ æœ‰ 10 ä¸ªæ–‡ä»¶æ”¹åŠ¨ï¼Œæƒ³åˆ† 3 æ‰¹æäº¤ï¼š

```powershell
PS E:\MyProject> .\interactive-commit.ps1

# å¯åŠ¨ä¿¡æ¯
[08:00:28] æ­£åœ¨åˆå§‹åŒ–...
[08:00:28] ä»“åº“æ ¹ç›®å½•: E:/MyProject
[08:00:28] å½“å‰åˆ†æ”¯: feature/new-api
[08:00:28] æ£€æµ‹åˆ° 10 ä¸ªå¾…å¤„ç†æ–‡ä»¶

# ========== ç¬¬ä¸€æ‰¹ï¼šä¿®å¤ bug ==========
----------------------------------------
å¾…å¤„ç†å˜æ›´ (å…± 10 é¡¹)ï¼š
 [1] M  src/api/user.js
 [2] M  src/api/auth.js
 [3] ?? tests/user.test.js
 [4] M  README.md
 [5] ?? .env
 ...

æŒ‡ä»¤: [æ•°å­—]é€‰æ‹© | [a]å…¨é€‰ | [r]åˆ·æ–° | [q]å®Œæˆå¹¶æ¨é€ | [x]å¼ºåˆ¶é€€å‡º
è¯·è¾“å…¥: 1 2 3

[08:01:05] æ­£åœ¨æš‚å­˜ 3 ä¸ªæ–‡ä»¶...
  âœ“ src/api/user.js
  âœ“ src/api/auth.js
  âœ“ tests/user.test.js

Commit Message (ç•™ç©ºå–æ¶ˆæœ¬æ¬¡æäº¤): fix: ä¿®å¤ç”¨æˆ·ç™»å½• bug

[08:01:30] âœ“ Commit æˆåŠŸï¼

# ========== ç¬¬äºŒæ‰¹ï¼šæ›´æ–°æ–‡æ¡£ ==========
----------------------------------------
å¾…å¤„ç†å˜æ›´ (å…± 7 é¡¹)ï¼š
 [1] M  README.md
 [2] ?? docs/api.md
 [3] ?? .env
 ...

è¯·è¾“å…¥: 1 2

Commit Message: docs: æ›´æ–° API æ–‡æ¡£

[08:02:10] âœ“ Commit æˆåŠŸï¼

# ========== å‰©ä½™æ–‡ä»¶æé†’ ==========
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âš ï¸  æ³¨æ„ï¼šè¿˜æœ‰ 5 ä¸ªæ–‡ä»¶æœªæäº¤ï¼
â•‘  ğŸ“Š ç»Ÿè®¡ï¼šåˆå§‹ 10 ä¸ª â†’ å·²æäº¤ 5 ä¸ª â†’ å‰©ä½™ 5 ä¸ª
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è¯·è¾“å…¥: q

# ========== é—æ¼æ£€æŸ¥ ==========
âš ï¸  è­¦å‘Šï¼šè¿˜æœ‰ 5 ä¸ªæ–‡ä»¶æœªæäº¤ï¼
è¿™äº›æ–‡ä»¶å°†ä¸ä¼šè¢«æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚

å‰©ä½™æ–‡ä»¶ï¼š
  â€¢ .env
  â€¢ config.prod.json
  ...

ç¡®è®¤è¦ç»“æŸæäº¤é˜¶æ®µå—ï¼Ÿ(è¾“å…¥ YES ç¡®è®¤ï¼Œå…¶ä»–ä»»æ„é”®è¿”å›)
> YES

# ========== æ¨é€é˜¶æ®µ ==========
[08:03:00] æœ‰ 2 ä¸ªæœ¬åœ°æäº¤å¾…æ¨é€ã€‚

å‡†å¤‡æ¨é€åˆ°è¿œç¨‹ä»“åº“...
ç¡®è®¤æ¨é€? (y/n): y

[08:03:05] æ­£åœ¨æ¨é€...
[08:03:10] âœ“ æ¨é€æˆåŠŸï¼

ğŸ“Š æœ¬æ¬¡ä¼šè¯ç»Ÿè®¡ï¼š
  â€¢ åˆå§‹æ–‡ä»¶æ•°ï¼š10
  â€¢ å·²æäº¤æ–‡ä»¶ï¼š5
  â€¢ é—æ¼æ–‡ä»¶æ•°ï¼š5

å·²æäº¤çš„æ–‡ä»¶åˆ—è¡¨ï¼š
  â€¢ src/api/user.js
  â€¢ src/api/auth.js
  â€¢ tests/user.test.js
  â€¢ README.md
  â€¢ docs/api.md

æŒ‰ä»»æ„é”®é€€å‡º...
```

------

<a id="è¯¦ç»†åŠŸèƒ½è¯´æ˜"></a>
## è¯¦ç»†åŠŸèƒ½è¯´æ˜

### 1. å¯åŠ¨æ£€æŸ¥

è„šæœ¬å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

#### 1.1 ä»“åº“æ£€æµ‹

```powershell
[08:00:28] æ­£åœ¨åˆå§‹åŒ–...
[08:00:28] ä»“åº“æ ¹ç›®å½•: E:/MyProject
```

- âœ… è‡ªåŠ¨æŸ¥æ‰¾ `.git` ç›®å½•
- âœ… æ”¯æŒåœ¨å­ç›®å½•ä¸­è¿è¡Œ
- âŒ å¦‚æœä¸åœ¨ä»“åº“å†…ï¼Œè„šæœ¬ä¼šç»ˆæ­¢

#### 1.2 Git çŠ¶æ€æ£€æµ‹

æ£€æŸ¥æ˜¯å¦æœ‰æœªå®Œæˆçš„æ“ä½œï¼š

| çŠ¶æ€               | è¯´æ˜             | è„šæœ¬è¡Œä¸º   |
| ------------------ | ---------------- | ---------- |
| `MERGE_HEAD`       | æ­£åœ¨åˆå¹¶         | ğŸ›‘ é˜»æ­¢è¿è¡Œ |
| `CHERRY_PICK_HEAD` | æ­£åœ¨ cherry-pick | ğŸ›‘ é˜»æ­¢è¿è¡Œ |
| `REVERT_HEAD`      | æ­£åœ¨ revert      | ğŸ›‘ é˜»æ­¢è¿è¡Œ |
| `rebase-apply`     | æ­£åœ¨ rebase      | ğŸ›‘ é˜»æ­¢è¿è¡Œ |
| `rebase-merge`     | æ­£åœ¨ rebase      | ğŸ›‘ é˜»æ­¢è¿è¡Œ |

**å¦‚æœæ£€æµ‹åˆ°é”ï¼š**

```
[08:00:28] ä¸¥é‡è­¦å‘Šï¼šæ£€æµ‹åˆ° Git æ­£åœ¨è¿›è¡Œå¤æ‚æ“ä½œ (MERGE_HEAD)ã€‚
[è„šæœ¬é”™è¯¯] è¯·å…ˆè§£å†³ Git çŠ¶æ€é”é—®é¢˜ã€‚
```

**å¦‚ä½•è§£å†³ï¼Ÿ**

```powershell
# æŸ¥çœ‹çŠ¶æ€
git status

# å®Œæˆæˆ–ä¸­æ­¢å½“å‰æ“ä½œ
git merge --abort      # ä¸­æ­¢åˆå¹¶
git rebase --abort     # ä¸­æ­¢ rebase
git cherry-pick --abort # ä¸­æ­¢ cherry-pick
```

#### 1.3 ä¸»åˆ†æ”¯ä¿æŠ¤

å¦‚æœå½“å‰åœ¨ `main` æˆ– `master` åˆ†æ”¯ï¼š

```powershell
[08:00:28] å½“å‰åˆ†æ”¯: main
[08:00:28] !!! è­¦å‘Šï¼šå½“å‰å¤„äºä¸»åˆ†æ”¯ 'main' !!!
ç¡®å®šè¦ç»§ç»­æ“ä½œå—ï¼Ÿ(è¾“å…¥ YES ç»§ç»­): _
```

- å¿…é¡»è¾“å…¥ `YES`ï¼ˆå¤§å†™ï¼‰æ‰èƒ½ç»§ç»­
- å…¶ä»–ä»»ä½•è¾“å…¥éƒ½ä¼šé€€å‡ºè„šæœ¬
- **ç›®çš„**: é˜²æ­¢è¯¯åœ¨ä¸»åˆ†æ”¯æäº¤ï¼Œå»ºè®®ä½¿ç”¨ feature åˆ†æ”¯

**å¦‚ä½•å…³é—­ï¼Ÿ**

```powershell
# ä¿®æ”¹è„šæœ¬é…ç½®
$Config = @{
    ProtectMainBranch = $false  # æ”¹ä¸º false
    ...
}
```

------

### 2. æ–‡ä»¶åˆ—è¡¨æ˜¾ç¤º

#### 2.1 çŠ¶æ€æ ‡è¯†

è„šæœ¬ä¼šç»™ä¸åŒçŠ¶æ€çš„æ–‡ä»¶åŠ ä¸Šé¢œè‰²ï¼š

| çŠ¶æ€ç  | å«ä¹‰             | é¢œè‰²   | ç¤ºä¾‹                      |
| ------ | ---------------- | ------ | ------------------------- |
| `M`    | å·²ä¿®æ”¹           | ğŸŸ¡ é»„è‰² | `[1] M  src/index.js`     |
| `A`    | å·²æš‚å­˜ï¼ˆæ–°å¢ï¼‰   | ğŸŸ¢ ç»¿è‰² | `[2] A  src/new.js`       |
| `??`   | æœªè·Ÿè¸ªï¼ˆæ–°æ–‡ä»¶ï¼‰ | ğŸŸ¢ ç»¿è‰² | `[3] ?? README.md`        |
| `D`    | å·²åˆ é™¤           | ğŸ”´ çº¢è‰² | `[4] D  old.txt`          |
| `R`    | é‡å‘½å           | ğŸŸ£ ç´«è‰² | `[5] R  old.js -> new.js` |

#### 2.2 ç‰¹æ®Šè·¯å¾„å¤„ç†

è„šæœ¬èƒ½æ­£ç¡®å¤„ç†ï¼š

```powershell
# âœ… ä¸­æ–‡è·¯å¾„
[1] ?? 9 months study/é“¶è¡Œå®¶ç®—æ³•.md

# âœ… å¸¦ç©ºæ ¼çš„è·¯å¾„
[2] M  "My Documents/file name.txt"

# âœ… é‡å‘½å
[3] R  old name.md -> new name.md
```

------

### 3. äº¤äº’æŒ‡ä»¤

#### 3.1 é€‰æ‹©æ–‡ä»¶

**å•é€‰ï¼š**

```powershell
è¯·è¾“å…¥: 3
# åªé€‰æ‹©ç¬¬ 3 ä¸ªæ–‡ä»¶
```

**å¤šé€‰ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰ï¼š**

```powershell
è¯·è¾“å…¥: 1 3 5 7
# é€‰æ‹© 1ã€3ã€5ã€7 å·æ–‡ä»¶
```

**å¤šé€‰ï¼ˆé€—å·åˆ†éš”ï¼‰ï¼š**

```powershell
è¯·è¾“å…¥: 1,3,5,7
# åŒæ ·é€‰æ‹© 1ã€3ã€5ã€7
```

**æ··åˆåˆ†éš”ï¼š**

```powershell
è¯·è¾“å…¥: 1, 3  5, 7
# è„šæœ¬ä¼šè‡ªåŠ¨è§£æ
```

#### 3.2 ç‰¹æ®ŠæŒ‡ä»¤

| æŒ‡ä»¤ | åŠŸèƒ½       | ä½¿ç”¨åœºæ™¯                 |
| ---- | ---------- | ------------------------ |
| `a`  | å…¨é€‰       | æƒ³ä¸€æ¬¡æäº¤æ‰€æœ‰æ–‡ä»¶       |
| `r`  | åˆ·æ–°åˆ—è¡¨   | å¤–éƒ¨ä¿®æ”¹äº†æ–‡ä»¶ï¼Œéœ€è¦æ›´æ–° |
| `q`  | å®Œæˆå¹¶æ¨é€ | å·²å®Œæˆæäº¤ï¼Œè¿›å…¥æ¨é€é˜¶æ®µ |
| `x`  | å¼ºåˆ¶é€€å‡º   | ç´§æ€¥é€€å‡ºï¼Œä¸æ¨é€         |

**ç¤ºä¾‹ï¼š**

```powershell
# å…¨é€‰æ‰€æœ‰æ–‡ä»¶
è¯·è¾“å…¥: a
[08:01:05] å·²é€‰æ‹©å…¨éƒ¨ 10 ä¸ªæ–‡ä»¶

# åˆ·æ–°ï¼ˆå¦‚æœä½ åœ¨å¦ä¸€ä¸ªçª—å£ä¿®æ”¹äº†ä»£ç ï¼‰
è¯·è¾“å…¥: r
[08:01:10] æ­£åœ¨åˆ·æ–°æ–‡ä»¶åˆ—è¡¨...

# å®Œæˆæäº¤ï¼Œå‡†å¤‡æ¨é€
è¯·è¾“å…¥: q
[08:01:15] ç»“æŸæäº¤é˜¶æ®µï¼Œè¿›å…¥æ¨é€...

# ç´§æ€¥é€€å‡ºï¼ˆä¸æ¨é€ï¼‰
è¯·è¾“å…¥: x
[08:01:20] å·²å¼ºåˆ¶é€€å‡ºï¼Œæœªæ‰§è¡Œæ¨é€ã€‚
```

------

### 4. æš‚å­˜è¿‡ç¨‹

#### 4.1 ç›®å½•æ£€æµ‹

è„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡ç›®å½•ï¼š

```powershell
[08:01:05] æ­£åœ¨æš‚å­˜ 5 ä¸ªæ–‡ä»¶...
  å¤„ç†: src/
[08:01:06] è·³è¿‡ç›®å½•: src/
  âœ“ src/index.js
  âœ“ src/api.js
```

#### 4.2 æ•æ„Ÿæ–‡ä»¶è­¦å‘Š

å¦‚æœé€‰æ‹©äº†æ•æ„Ÿæ–‡ä»¶ï¼š

```powershell
  å¤„ç†: .env
!!! æ•æ„Ÿæ–‡ä»¶: .env !!!
ç¡®è®¤æš‚å­˜? (y/n): _
```

- è¾“å…¥ `y` ç»§ç»­æš‚å­˜
- è¾“å…¥ `n` è·³è¿‡è¯¥æ–‡ä»¶

**è§¦å‘æ¨¡å¼ï¼ˆå¯é…ç½®ï¼‰ï¼š**

```powershell
$Config.SensitivePatterns = @(
    ".env",
    "*.key",
    "id_rsa",
    "secrets.*",
    "*credentials*",
    "config.prod*"
)
```

#### 4.3 å¤§æ–‡ä»¶æé†’

æ–‡ä»¶è¶…è¿‡é˜ˆå€¼æ—¶ï¼š

```powershell
  å¤„ç†: video.mp4
[08:01:10] å¤§æ–‡ä»¶è­¦å‘Š: video.mp4 (156.78 MB)
  âœ“ video.mp4
```

- åªæé†’ï¼Œä¸é˜»æ­¢
- é»˜è®¤é˜ˆå€¼ï¼š50 MB
- å¯é€šè¿‡ `$Config.LargeFileThresholdMB` ä¿®æ”¹

#### 4.4 æš‚å­˜ç¡®è®¤

æš‚å­˜æˆåŠŸåæ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼š

```powershell
å½“å‰æš‚å­˜åŒºçŠ¶æ€:
A  src/index.js
A  src/api.js
M  README.md
?? .env
```

- ç»¿è‰²çš„ `A`/`M` = å·²æš‚å­˜
- çº¢è‰²çš„ `??` = æœªæš‚å­˜

------
<a id="Commitæ“ä½œ"></a>

### 5. Commit æ“ä½œ

#### 5.1 è¾“å…¥ Message

```powershell
Commit Message (ç•™ç©ºå–æ¶ˆæœ¬æ¬¡æäº¤): _
```

**è§„èŒƒå»ºè®®ï¼š**

```
feat: æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½
fix: ä¿®å¤è´­ç‰©è½¦è®¡ç®—é”™è¯¯
docs: æ›´æ–° API æ–‡æ¡£
style: æ ¼å¼åŒ–ä»£ç 
refactor: é‡æ„æ”¯ä»˜æ¨¡å—
test: æ·»åŠ å•å…ƒæµ‹è¯•
chore: æ›´æ–°ä¾èµ–ç‰ˆæœ¬
```

#### 5.2 ç©º Message å–æ¶ˆ

```powershell
Commit Message (ç•™ç©ºå–æ¶ˆæœ¬æ¬¡æäº¤): 

[08:01:30] å·²å–æ¶ˆæäº¤ã€‚
[08:01:30] æ­£åœ¨æ’¤é”€æš‚å­˜...
```

- è‡ªåŠ¨æ‰§è¡Œ `git reset HEAD`
- æ–‡ä»¶å›åˆ°æœªæš‚å­˜çŠ¶æ€
- ä¸ä¼šä¸¢å¤±æ”¹åŠ¨

#### 5.3 Commit æˆåŠŸ

```powershell
[main e560189] feat: æ·»åŠ ç”¨æˆ·ç™»å½•
 3 files changed, 256 insertions(+)
 create mode 100644 src/login.js
[08:01:35] âœ“ Commit æˆåŠŸï¼
```

------


<a id="é—æ¼æ£€æµ‹ç³»ç»Ÿ"></a>

### 6. é—æ¼æ£€æµ‹ç³»ç»Ÿ â­

è¿™æ˜¯è„šæœ¬çš„**æ ¸å¿ƒäº®ç‚¹åŠŸèƒ½**ï¼

#### 6.1 å®æ—¶ç»Ÿè®¡

æ¯è½®æäº¤åï¼Œå¦‚æœè¿˜æœ‰å‰©ä½™æ–‡ä»¶ï¼š

```powershell
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âš ï¸  æ³¨æ„ï¼šè¿˜æœ‰ 3 ä¸ªæ–‡ä»¶æœªæäº¤ï¼
â•‘  ğŸ“Š ç»Ÿè®¡ï¼šåˆå§‹ 10 ä¸ª â†’ å·²æäº¤ 7 ä¸ª â†’ å‰©ä½™ 3 ä¸ª
â•‘  ğŸ’¡ å»ºè®®ï¼šè¾“å…¥ [r] åˆ·æ–°åˆ—è¡¨ï¼Œç¡®è®¤æ˜¯å¦è¿˜æœ‰æ–‡ä»¶éœ€è¦å¤„ç†
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### 6.2 é€€å‡ºäºŒæ¬¡ç¡®è®¤

è¾“å…¥ `q` æ—¶ï¼Œå¦‚æœæœ‰å‰©ä½™æ–‡ä»¶ï¼š

```powershell
âš ï¸  è­¦å‘Šï¼šè¿˜æœ‰ 3 ä¸ªæ–‡ä»¶æœªæäº¤ï¼
è¿™äº›æ–‡ä»¶å°†ä¸ä¼šè¢«æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚

å‰©ä½™æ–‡ä»¶ï¼š
  â€¢ config.prod.json
  â€¢ .env
  â€¢ backup.sql

ç¡®è®¤è¦ç»“æŸæäº¤é˜¶æ®µå—ï¼Ÿ(è¾“å…¥ YES ç¡®è®¤ï¼Œå…¶ä»–ä»»æ„é”®è¿”å›)
> _
```

- è¾“å…¥ `YES` â†’ ç¡®è®¤é€€å‡ºï¼Œè¿›å…¥æ¨é€
- å…¶ä»–è¾“å…¥ â†’ è¿”å›æ–‡ä»¶é€‰æ‹©ï¼Œç»§ç»­å¤„ç†

#### 6.3 æ¨é€å‰æœ€ç»ˆæ£€æŸ¥

å³ä½¿ä½ ç¡®è®¤é€€å‡ºï¼Œæ¨é€å‰è¿˜ä¼šå†æ¬¡æ£€æŸ¥ï¼š

```powershell
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âŒ å‘ç°é—æ¼æ–‡ä»¶ï¼
â•‘  ä»¥ä¸‹ 3 ä¸ªæ–‡ä»¶æœªè¢«æäº¤ï¼š
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘    â€¢ config.prod.json
â•‘    â€¢ .env
â•‘    â€¢ backup.sql
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  å»ºè®®è¿”å›å¤„ç† (è¾“å…¥ n è¿”å›)
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä»ç„¶ç»§ç»­æ¨é€ï¼Ÿ(y/n): _
```

- è¾“å…¥ `y` â†’ æ¨é€ï¼ˆä½†é—æ¼æ–‡ä»¶ä¸ä¼šè¢«æ¨é€ï¼‰
- è¾“å…¥ `n` â†’ é€€å‡ºè„šæœ¬ï¼Œå¯é‡æ–°è¿è¡Œå¤„ç†

------



<a id="æ¨é€é˜¶æ®µ"></a>

### 7. æ¨é€é˜¶æ®µ

#### 7.1 çŠ¶æ€æ£€æµ‹

è„šæœ¬ä¼šæ™ºèƒ½åˆ¤æ–­æ¨é€æƒ…å†µï¼š

| æƒ…å†µ        | è¯´æ˜         | è„šæœ¬è¡Œä¸º                      |
| ----------- | ------------ | ----------------------------- |
| æ—  upstream | åˆ†æ”¯é¦–æ¬¡æ¨é€ | `git push -u origin <branch>` |
| è½åè¿œç«¯    | æœ¬åœ°æ—§äºè¿œç«¯ | âš ï¸ å»ºè®®å…ˆ pullï¼Œä¸æ¨é€         |
| é¢†å…ˆè¿œç«¯    | æœ‰æ–°æäº¤å¾…æ¨ | âœ… å¯ä»¥æ¨é€                    |
| å·²åŒæ­¥      | æ— éœ€æ¨é€     | â„¹ï¸ æç¤ºå·²åŒæ­¥                  |

#### 7.2 æ¨é€ç¤ºä¾‹

**åœºæ™¯ 1ï¼šæ­£å¸¸æ¨é€**

```powershell
[08:03:00] æœ‰ 2 ä¸ªæœ¬åœ°æäº¤å¾…æ¨é€ã€‚

å‡†å¤‡æ¨é€åˆ°è¿œç¨‹ä»“åº“...
ç¡®è®¤æ¨é€? (y/n): y

[08:03:05] æ­£åœ¨æ¨é€...
Enumerating objects: 10, done.
Counting objects: 100% (10/10), done.
...
To https://github.com/user/repo.git
   abc1234..def5678  feature -> feature
[08:03:10] âœ“ æ¨é€æˆåŠŸï¼
```

**åœºæ™¯ 2ï¼šé¦–æ¬¡æ¨é€**

```powershell
[08:03:00] å½“å‰åˆ†æ”¯æ— ä¸Šæ¸¸åˆ†æ”¯ï¼Œéœ€è¦é¦–æ¬¡æ¨é€ã€‚
[08:03:00] å°†è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯ä¸º: origin/feature-new

ç¡®è®¤æ¨é€? (y/n): y

[08:03:05] æ­£åœ¨æ¨é€...
# è‡ªåŠ¨æ‰§è¡Œ: git push -u origin feature-new
```

**åœºæ™¯ 3ï¼šè½åè¿œç«¯**

```powershell
[08:03:00] âš  æœ¬åœ°è½åè¿œç«¯ 3 ä¸ªæäº¤ï¼Œå»ºè®®å…ˆæ‰§è¡Œ 'git pull'ã€‚

# ä¸ä¼šæç¤ºæ¨é€ï¼Œéœ€è¦å…ˆåŒæ­¥
```

------

<a id="æœ€ç»ˆç»Ÿè®¡"></a>
### 8. æœ€ç»ˆç»Ÿè®¡

æ¨é€å®Œæˆåï¼Œæ˜¾ç¤ºä¼šè¯æ±‡æ€»ï¼š

```powershell
========================================
ğŸ“Š æœ¬æ¬¡ä¼šè¯ç»Ÿè®¡ï¼š
  â€¢ åˆå§‹æ–‡ä»¶æ•°ï¼š10
  â€¢ å·²æäº¤æ–‡ä»¶ï¼š7
  â€¢ é—æ¼æ–‡ä»¶æ•°ï¼š3

å·²æäº¤çš„æ–‡ä»¶åˆ—è¡¨ï¼š
  â€¢ src/api/user.js
  â€¢ src/api/auth.js
  â€¢ tests/user.test.js
  â€¢ README.md
  â€¢ docs/api.md
  â€¢ src/utils/helper.js
  â€¢ package.json

âš ï¸  æé†’ï¼šæœ‰ 3 ä¸ªæ–‡ä»¶æœªæäº¤

æŒ‰ä»»æ„é”®é€€å‡º...
```

------

## é«˜çº§ç”¨æ³•

### 1. å¿«æ·æ–¹å¼é…ç½®

**æ–¹æ³• 1ï¼šæ·»åŠ åˆ° PATH**

```powershell
# å°†è„šæœ¬ç›®å½•åŠ å…¥ PATH
$env:PATH += ";C:\Scripts"

# ç°åœ¨å¯ä»¥åœ¨ä»»ä½•ä½ç½®è¿è¡Œ
cd E:\MyProject
interactive-commit.ps1
```

**æ–¹æ³• 2ï¼šPowerShell åˆ«å**

```powershell
# æ·»åŠ åˆ° PowerShell é…ç½®æ–‡ä»¶
notepad $PROFILE

# æ·»åŠ è¿™è¡Œ
Set-Alias gic "C:\Scripts\interactive-commit.ps1"

# é‡æ–°åŠ è½½é…ç½®
. $PROFILE

# ä½¿ç”¨åˆ«å
gic
```

**æ–¹æ³• 3ï¼šå³é”®èœå•ï¼ˆWindowsï¼‰**

```powershell
# åˆ›å»º .reg æ–‡ä»¶æ·»åŠ å³é”®èœå•
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Directory\Background\shell\GitCommit]
@="Git äº¤äº’æäº¤"

[HKEY_CLASSES_ROOT\Directory\Background\shell\GitCommit\command]
@="powershell.exe -NoExit -File \"C:\\Scripts\\interactive-commit.ps1\""
```

------

### 2. æ‰¹é‡æ“ä½œæŠ€å·§

#### æŠ€å·§ 1ï¼šæŒ‰æ–‡ä»¶ç±»å‹åˆ†æ‰¹

```powershell
# ç¬¬ä¸€æ‰¹ï¼šæäº¤æ‰€æœ‰ .js æ–‡ä»¶ï¼ˆå‡è®¾æ˜¯ 1-5 å·ï¼‰
è¯·è¾“å…¥: 1 2 3 4 5
Commit Message: feat: æ›´æ–° JavaScript æ¨¡å—

# ç¬¬äºŒæ‰¹ï¼šæäº¤æ‰€æœ‰ .md æ–‡ä»¶ï¼ˆ6-8 å·ï¼‰
è¯·è¾“å…¥: 6 7 8
Commit Message: docs: æ›´æ–°æ–‡æ¡£

# ç¬¬ä¸‰æ‰¹ï¼šæäº¤é…ç½®æ–‡ä»¶ï¼ˆ9-10 å·ï¼‰
è¯·è¾“å…¥: 9 10
Commit Message: chore: æ›´æ–°é…ç½®
```

#### æŠ€å·§ 2ï¼šä½¿ç”¨åˆ·æ–°åŠŸèƒ½

```powershell
# åœºæ™¯ï¼šä½ æƒ³ä¿®æ”¹æŸä¸ªæ–‡ä»¶åå†æäº¤

è¯·è¾“å…¥: 1 2 3   # å…ˆæäº¤å‰ 3 ä¸ª
Commit Message: fix: ä¿®å¤ bug

# æ­¤æ—¶ä½ åœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹äº†ç¬¬ 4 ä¸ªæ–‡ä»¶

è¯·è¾“å…¥: r        # åˆ·æ–°åˆ—è¡¨
# åˆ—è¡¨ä¼šæ›´æ–°ï¼Œç¡®ä¿ç¬¬ 4 ä¸ªæ–‡ä»¶çš„æœ€æ–°çŠ¶æ€

è¯·è¾“å…¥: 4        # æäº¤ä¿®æ”¹åçš„æ–‡ä»¶
```

#### æŠ€å·§ 3ï¼šåˆ†é˜¶æ®µæäº¤

```powershell
# é˜¶æ®µ 1ï¼šæ ¸å¿ƒåŠŸèƒ½
é€‰æ‹©: 1-10
Message: feat: å®ç°æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

# é˜¶æ®µ 2ï¼šæµ‹è¯•
é€‰æ‹©: 11-15
Message: test: æ·»åŠ å•å…ƒæµ‹è¯•

# é˜¶æ®µ 3ï¼šæ–‡æ¡£
é€‰æ‹©: 16-20
Message: docs: å®Œå–„ä½¿ç”¨æ–‡æ¡£

# é˜¶æ®µ 4ï¼šæ ·å¼è°ƒæ•´
é€‰æ‹©: 21-25
Message: style: ä¼˜åŒ–ä»£ç æ ¼å¼
```

------

### 3. è‡ªå®šä¹‰é…ç½®æ¨¡æ¿

æ ¹æ®ä¸åŒé¡¹ç›®éœ€æ±‚ï¼Œåˆ›å»ºé…ç½®å˜ä½“ï¼š

**æ¨¡æ¿ 1ï¼šæ•æ„Ÿé¡¹ç›®ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰**

```powershell
$Config = @{
    ProtectMainBranch    = $true
    SensitivePatterns    = @(
        ".env*",
        "*.key",
        "*.pem",
        "*.p12",
        "id_rsa*",
        "secrets*",
        "*password*",
        "*token*",
        "*.pfx",
        "config.prod*",
        "database.json"
    )
    LargeFileThresholdMB = 20  # æ›´ä¸¥æ ¼
    TargetRepoPath       = ""
}
```

**æ¨¡æ¿ 2ï¼šå¼€æºé¡¹ç›®ï¼ˆå®½æ¾æ¨¡å¼ï¼‰**

```powershell
$Config = @{
    ProtectMainBranch    = $false  # å…è®¸ä¸»åˆ†æ”¯æäº¤
    SensitivePatterns    = @(
        ".env"  # ä»…åŸºæœ¬ä¿æŠ¤
    )
    LargeFileThresholdMB = 100  # å…è®¸å¤§æ–‡ä»¶
    TargetRepoPath       = ""
}
```

**æ¨¡æ¿ 3ï¼šå¤šåª’ä½“é¡¹ç›®**

```powershell
$Config = @{
    ProtectMainBranch    = $true
    SensitivePatterns    = @(".env")
    LargeFileThresholdMB = 500  # è§†é¢‘/å›¾ç‰‡é¡¹ç›®
    TargetRepoPath       = ""
}
```

------

### 4. å›¢é˜Ÿåä½œè§„èŒƒ

#### è§„èŒƒ 1ï¼šCommit Message è§„èŒƒ

å»ºè®®å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š

```
<type>(<scope>): <subject>

<body>

<footer>
```

**ç¤ºä¾‹ï¼š**

```
feat(auth): æ·»åŠ åŒå› ç´ è®¤è¯

- å®ç° TOTP éªŒè¯
- æ·»åŠ å¤‡ç”¨éªŒè¯ç 
- æ›´æ–°ç”¨æˆ·è®¾ç½®é¡µé¢

Closes #123
```

**Type ç±»å‹ï¼š**

- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ bug
- `docs`: æ–‡æ¡£
- `style`: æ ¼å¼ï¼ˆä¸å½±å“ä»£ç ï¼‰
- `refactor`: é‡æ„
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•
- `chore`: æ„å»º/å·¥å…·

#### è§„èŒƒ 2ï¼šåˆ†æ”¯å‘½å

```
feature/user-authentication
bugfix/login-error
hotfix/security-patch
release/v1.2.0
```

#### è§„èŒƒ 3ï¼šæäº¤é¢‘ç‡

- âœ… **æ¨è**: æ¯ä¸ªé€»è¾‘åŠŸèƒ½ä¸€ä¸ª commit
- âœ… **æ¨è**: æ¯å¤©è‡³å°‘æ¨é€ä¸€æ¬¡
- âŒ **é¿å…**: ä¸€ä¸ª commit åŒ…å«æ— å…³æ”¹åŠ¨
- âŒ **é¿å…**: æäº¤ä¿¡æ¯æ¨¡ç³Šï¼ˆå¦‚ "update"ï¼‰

------

<a id="å¸¸è§é—®é¢˜"></a>

## å¸¸è§é—®é¢˜

### Q1: è„šæœ¬æ— æ³•è¿è¡Œï¼Œæç¤º"æ— æ³•åŠ è½½"ï¼Ÿ

**åŸå› **: æ‰§è¡Œç­–ç•¥é™åˆ¶

**è§£å†³**:

```powershell
# ä¸´æ—¶å…è®¸
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process

# æ°¸ä¹…å…è®¸ï¼ˆå½“å‰ç”¨æˆ·ï¼‰
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

------

### Q2: ä¸­æ–‡æ–‡ä»¶åæ˜¾ç¤ºä¹±ç æˆ–æ— æ³•é€‰æ‹©ï¼Ÿ

**åŸå› **: æ–‡ä»¶ç¼–ç ä¸æ˜¯ UTF-8 with BOM

**è§£å†³**:

1. ç”¨ VS Code æ‰“å¼€è„šæœ¬
2. å³ä¸‹è§’ç‚¹å‡»ç¼–ç ï¼ˆå¦‚ "UTF-8"ï¼‰
3. é€‰æ‹© "Save with Encoding"
4. é€‰æ‹© "UTF-8 with BOM"
5. é‡æ–°è¿è¡Œè„šæœ¬

------

### Q3: æç¤º"è·¯å¾„ä¸­å…·æœ‰éæ³•å­—ç¬¦"ï¼Ÿ

**åŸå› **: PowerShell ç‰ˆæœ¬è¿‡æ—§æˆ–è·¯å¾„ç‰¹æ®Šå­—ç¬¦

**è§£å†³**:

```powershell
# æ£€æŸ¥ PowerShell ç‰ˆæœ¬
$PSVersionTable.PSVersion

# å¦‚æœæ˜¯ 5.1ï¼Œå‡çº§åˆ° 7.x
winget install Microsoft.PowerShell
```

------

### Q4: æ–‡ä»¶æ¶ˆå¤±äº†ï¼Œæ˜æ˜æœ‰å˜æ›´ä½†åˆ—è¡¨ä¸æ˜¾ç¤ºï¼Ÿ

**åŸå› **: Git å¿½ç•¥è§„åˆ™æˆ–æ–‡ä»¶åœ¨ `.gitignore` ä¸­

**æ£€æŸ¥**:

```powershell
# æŸ¥çœ‹å®Œæ•´çŠ¶æ€
git status --ignored

# æ£€æŸ¥ç‰¹å®šæ–‡ä»¶
git check-ignore -v <æ–‡ä»¶è·¯å¾„>

# å¼ºåˆ¶æ·»åŠ ï¼ˆå¦‚æœç¡®å®éœ€è¦ï¼‰
git add -f <æ–‡ä»¶è·¯å¾„>
```

------

### Q5: æ¨é€å¤±è´¥ï¼Œæç¤º"æƒé™æ‹’ç»"ï¼Ÿ

**å¯èƒ½åŸå› **:

1. GitHub token è¿‡æœŸ
2. SSH å¯†é’¥æœªé…ç½®
3. ä»“åº“æ— å†™æƒé™

**è§£å†³**:

```powershell
# æ£€æŸ¥è¿œç¨‹ URL
git remote -v

# HTTPS æ–¹å¼ï¼šæ›´æ–° token
git remote set-url origin https://<token>@github.com/user/repo.git

# SSH æ–¹å¼ï¼šæ£€æŸ¥å¯†é’¥
ssh -T git@github.com
```

------

### Q6: å¦‚ä½•æ’¤é”€åˆšæ‰çš„æäº¤ï¼Ÿ

**åœºæ™¯ 1ï¼šè¿˜æ²¡æ¨é€**

```powershell
# æ’¤é”€æœ€è¿‘ä¸€æ¬¡ commitï¼Œä¿ç•™æ”¹åŠ¨
git reset --soft HEAD~1

# æ’¤é”€ commit å’Œæš‚å­˜ï¼Œä¿ç•™æ”¹åŠ¨
git reset HEAD~1

# å®Œå…¨æ’¤é”€ï¼ˆå±é™©ï¼ï¼‰
git reset --hard HEAD~1
```

**åœºæ™¯ 2ï¼šå·²ç»æ¨é€**

```powershell
# åˆ›å»ºåå‘æäº¤
git revert HEAD

# å¼ºåˆ¶è¦†ç›–ï¼ˆå›¢é˜Ÿæ…ç”¨ï¼ï¼‰
git push -f origin <branch>
```

------

### Q7: è„šæœ¬è¿è¡Œå¾ˆæ…¢ï¼Ÿ

**å¯èƒ½åŸå› **:

1. æ–‡ä»¶æ•°é‡å¤ªå¤šï¼ˆ500+ ä¸ªï¼‰
2. ä»“åº“ä½“ç§¯å¤ªå¤§
3. ç½‘ç»œé—®é¢˜

**ä¼˜åŒ–**:

```powershell
# æŸ¥çœ‹ä»“åº“å¤§å°
git count-objects -vH

# æ¸…ç†ä¸éœ€è¦çš„æ–‡ä»¶
git clean -fd

# å¿½ç•¥å¤§å‹æ–‡ä»¶å¤¹ï¼ˆæ·»åŠ åˆ° .gitignoreï¼‰
node_modules/
.venv/
dist/
```

------

### Q8: æƒ³è·³è¿‡æ•æ„Ÿæ–‡ä»¶æ£€æŸ¥ï¼Ÿ

**ä¸´æ—¶è·³è¿‡**: åœ¨è„šæœ¬è¿è¡Œæ—¶ï¼Œçœ‹åˆ°è­¦å‘Šç›´æ¥è¾“å…¥ `y`

**æ°¸ä¹…è·³è¿‡**:

```powershell
# ä¿®æ”¹é…ç½®
$Config = @{
    SensitivePatterns = @()  # æ¸…ç©ºè§„åˆ™
}
```

------

### Q9: å¦‚ä½•å¤„ç†é‡å‘½åæ–‡ä»¶ï¼Ÿ

è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹é‡å‘½åï¼ˆæ˜¾ç¤ºä¸º `R old -> new`ï¼‰ï¼Œé€‰æ‹©åä¼šæ­£ç¡®æäº¤ï¼š

```powershell
[5] R  src/old-name.js -> src/new-name.js

# é€‰æ‹©æ—¶åªéœ€è¾“å…¥ç¼–å·
è¯·è¾“å…¥: 5

# Git ä¼šè‡ªåŠ¨å¤„ç†é‡å‘½å
```

**æ³¨æ„**: Git é€šè¿‡ç›¸ä¼¼åº¦æ£€æµ‹é‡å‘½åï¼Œè‡³å°‘ 50% ç›¸åŒ

------

### Q10: èƒ½å¦åŒæ—¶è¿è¡Œå¤šä¸ªè„šæœ¬å®ä¾‹ï¼Ÿ

**ä¸æ¨èï¼** å¯èƒ½å¯¼è‡´ï¼š

- æš‚å­˜åŒºå†²çª
- Commit æ··ä¹±
- æ¨é€å†²çª

**å¦‚æœå¿…é¡»**: åœ¨ä¸åŒåˆ†æ”¯ã€ä¸åŒä»“åº“ä¸­è¿è¡Œ

------

<a id="æ•…éšœæ’æŸ¥"></a>

## æ•…éšœæ’æŸ¥

### æ’æŸ¥æµç¨‹

```
1. æ£€æŸ¥ PowerShell ç‰ˆæœ¬
   â†“
2. æ£€æŸ¥ Git ç‰ˆæœ¬å’Œé…ç½®
   â†“
3. æ£€æŸ¥æ–‡ä»¶ç¼–ç ï¼ˆUTF-8 with BOMï¼‰
   â†“
4. æ£€æŸ¥æ‰§è¡Œç­–ç•¥
   â†“
5. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
   â†“
6. å°è¯•æ‰‹åŠ¨æ‰§è¡Œ Git å‘½ä»¤
```

### è¯Šæ–­å‘½ä»¤

```powershell
# 1. ç³»ç»Ÿä¿¡æ¯
$PSVersionTable
git --version
Get-ExecutionPolicy -List

# 2. ä»“åº“çŠ¶æ€
git status
git branch -vv
git remote -v

# 3. è„šæœ¬æ–‡ä»¶æ£€æŸ¥
Get-Content .\interactive-commit.ps1 -Encoding UTF8 | Select-Object -First 5

# 4. æµ‹è¯• Git å‘½ä»¤
git status --porcelain=v1
git rev-parse --show-toplevel

# 5. æƒé™æ£€æŸ¥
Test-Path .git -PathType Container
(Get-Item .git).Attributes
```

------



<a id="æœ€ä½³å®è·µ"></a>

## æœ€ä½³å®è·µ

### 1. æäº¤å‰æ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²æµ‹è¯•é€šè¿‡
- [ ] æ— æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€tokenï¼‰
- [ ] Commit message æ¸…æ™°æ˜ç¡®
- [ ] ç›¸å…³æ–‡ä»¶åˆ†ç»„æäº¤
- [ ] æ£€æŸ¥æ˜¯å¦æœ‰é—æ¼æ–‡ä»¶
- [ ] ç¡®è®¤åˆ†æ”¯æ­£ç¡®

### 2. åˆ†æ‰¹æäº¤ç­–ç•¥

**æŒ‰åŠŸèƒ½åˆ†æ‰¹**:

```
ç¬¬ 1 æ‰¹: æ ¸å¿ƒé€»è¾‘å®ç°
ç¬¬ 2 æ‰¹: é”™è¯¯å¤„ç†
ç¬¬ 3 æ‰¹: å•å…ƒæµ‹è¯•
ç¬¬ 4 æ‰¹: æ–‡æ¡£æ›´æ–°
```

**æŒ‰æ–‡ä»¶ç±»å‹åˆ†æ‰¹**:

```
ç¬¬ 1 æ‰¹: åç«¯ä»£ç  (*.js, *.py)
ç¬¬ 2 æ‰¹: å‰ç«¯ä»£ç  (*.vue, *.css)
ç¬¬ 3 æ‰¹: é…ç½®æ–‡ä»¶ (*.json, *.yaml)
ç¬¬ 4 æ‰¹: æ–‡æ¡£ (*.md)
```

### 3. Commit Message æœ€ä½³å®è·µ

**å¥½çš„ç¤ºä¾‹**:

```
âœ… feat(auth): æ·»åŠ  JWT è®¤è¯ä¸­é—´ä»¶
âœ… fix(api): ä¿®å¤ç”¨æˆ·æŸ¥è¯¢ç©ºæŒ‡é’ˆå¼‚å¸¸
âœ… docs: æ›´æ–° API æ–‡æ¡£ v2.0
âœ… refactor(db): ä¼˜åŒ–æ•°æ®åº“è¿æ¥æ± é…ç½®
```

**ä¸å¥½çš„ç¤ºä¾‹**:

```
âŒ update
âŒ fix bug
âŒ æ”¹äº†ä¸€äº›ä¸œè¥¿
âŒ asjdlkajsdlkj
```

### 4. åˆ†æ”¯ç®¡ç†å»ºè®®

```
main (ç”Ÿäº§)
  â”œâ”€â”€ develop (å¼€å‘)
  â”‚    â”œâ”€â”€ feature/user-login
  â”‚    â”œâ”€â”€ feature/payment
  â”‚    â””â”€â”€ feature/notification
  â”œâ”€â”€ hotfix/security-patch
  â””â”€â”€ release/v1.2.0
```

**å·¥ä½œæµ**:

1. ä» `develop` åˆ›å»º feature åˆ†æ”¯
2. å¼€å‘å®Œæˆåç”¨è„šæœ¬åˆ†æ‰¹æäº¤
3. æ¨é€åˆ°è¿œç¨‹
4. åˆ›å»º Pull Request
5. Code Review ååˆå¹¶

### 5. å›¢é˜Ÿåä½œè§„èŒƒ

**è§„èŒƒ 1: æäº¤é¢‘ç‡**

- æ¯å®Œæˆä¸€ä¸ªå°åŠŸèƒ½å°±æäº¤
- æ¯å¤©è‡³å°‘æ¨é€ä¸€æ¬¡
- ä¸‹ç­å‰ç¡®ä¿ä»£ç å·²æ¨é€

**è§„èŒƒ 2: åˆ†æ”¯å‘½å**

```
feature/<åŠŸèƒ½å>     # æ–°åŠŸèƒ½
bugfix/<bugæè¿°>     # bug ä¿®å¤
hotfix/<ç´§æ€¥ä¿®å¤>    # ç”Ÿäº§çƒ­ä¿®å¤
release/<ç‰ˆæœ¬å·>     # å‘å¸ƒåˆ†æ”¯
```

**è§„èŒƒ 3: Code Review**

- æäº¤å‰è‡ªæŸ¥ä»£ç 
- ä¿æŒæäº¤ç²’åº¦é€‚ä¸­
- åŠæ—¶å“åº” Review æ„è§

------

<a id="é…ç½®å‚è€ƒ"></a>

## é…ç½®å‚è€ƒ

### å®Œæ•´é…ç½®è¯´æ˜

```powershell
$Config = @{
    # ============ åˆ†æ”¯ä¿æŠ¤ ============
    # æ˜¯å¦ä¿æŠ¤ä¸»åˆ†æ”¯ï¼ˆé˜²æ­¢è¯¯æäº¤åˆ° main/masterï¼‰
    # true: éœ€è¦è¾“å…¥ YES ç¡®è®¤
    # false: ç›´æ¥å…è®¸
    ProtectMainBranch = $true
    
    # ============ æ•æ„Ÿæ–‡ä»¶è§„åˆ™ ============
    # æ”¯æŒé€šé…ç¬¦åŒ¹é…ï¼ˆ*, ?ï¼‰
    # åŒ¹é…æ—¶ä¼šé«˜äº®è­¦å‘Šå¹¶è¦æ±‚äºŒæ¬¡ç¡®è®¤
    SensitivePatterns = @(
        ".env",           # ç¯å¢ƒå˜é‡
        ".env.*",         # .env.local, .env.production
        "*.key",          # å¯†é’¥æ–‡ä»¶
        "*.pem",          # SSL è¯ä¹¦
        "id_rsa",         # SSH ç§é’¥
        "id_rsa.*",       # id_rsa.pub ç­‰
        "secrets.*",      # secrets.yaml, secrets.json
        "*credentials*",  # credentials.txt, aws-credentials
        "*password*",     # password.txt, passwords.json
        "*token*",        # api-token.txt, tokens.json
        "config.prod*",   # config.production.js
        "*.pfx",          # Windows è¯ä¹¦
        "*.p12"           # iOS è¯ä¹¦
    )
    
    # ============ å¤§æ–‡ä»¶é˜ˆå€¼ ============
    # å•ä½ï¼šMB
    # è¶…è¿‡æ­¤å¤§å°ä¼šè­¦å‘Šï¼ˆä½†ä¸é˜»æ­¢ï¼‰
    LargeFileThresholdMB = 50
    
    # ============ å¤‡ç”¨ä»“åº“è·¯å¾„ ============
    # å¦‚æœå½“å‰ç›®å½•æ‰¾ä¸åˆ°ä»“åº“ï¼Œå°è¯•æ­¤è·¯å¾„
    # ç•™ç©º "" è¡¨ç¤ºä¸ä½¿ç”¨å¤‡ç”¨è·¯å¾„
    TargetRepoPath = ""
    
    # æˆ–æŒ‡å®šå…·ä½“è·¯å¾„ï¼š
    # TargetRepoPath = "E:\Projects\MyRepo"
}
```

### æŒ‰é¡¹ç›®ç±»å‹æ¨èé…ç½®

**Web å‰ç«¯é¡¹ç›®**:

```powershell
$Config = @{
    ProtectMainBranch = $true
    SensitivePatterns = @(".env*", "*.key", "*token*")
    LargeFileThresholdMB = 10  # å‰ç«¯èµ„æºä¸åº”å¤ªå¤§
    TargetRepoPath = ""
}
```

**åç«¯ API é¡¹ç›®**:

```powershell
$Config = @{
    ProtectMainBranch = $true
    SensitivePatterns = @(
        ".env*",
        "database.*",
        "*credentials*",
        "config.prod*"
    )
    LargeFileThresholdMB = 50
    TargetRepoPath = ""
}
```

**æ•°æ®ç§‘å­¦é¡¹ç›®**:

```powershell
$Config = @{
    ProtectMainBranch = $false  # ç»å¸¸éœ€è¦åœ¨ main æäº¤
    SensitivePatterns = @(".env", "*.key")
    LargeFileThresholdMB = 500  # å…è®¸å¤§å‹æ•°æ®é›†
    TargetRepoPath = ""
}
```

------

<a id="è¿›é˜¶æŠ€å·§"></a>

## è¿›é˜¶æŠ€å·§

### 1. é›†æˆåˆ° IDE

**VS Code é›†æˆ**:

1. å®‰è£… "Tasks" æ‰©å±•
2. åˆ›å»º `.vscode/tasks.json`:

```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Git äº¤äº’æäº¤",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-File",
        "C:\\Scripts\\interactive-commit.ps1"
      ],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated"
      }
    }
  ]
}
```

1. æŒ‰ `Ctrl+Shift+P` â†’ "Tasks: Run Task" â†’ é€‰æ‹©ä»»åŠ¡

------

### 2. è‡ªåŠ¨åŒ–è„šæœ¬é“¾

```powershell
# pre-commit.ps1 - æäº¤å‰è‡ªåŠ¨æ£€æŸ¥
.\lint-check.ps1          # ä»£ç æ ¼å¼æ£€æŸ¥
.\run-tests.ps1           # è¿è¡Œæµ‹è¯•
.\interactive-commit.ps1  # äº¤äº’å¼æäº¤
```

------

### 3. æ—¥å¿—è®°å½•

åœ¨è„šæœ¬æœ«å°¾æ·»åŠ æ—¥å¿—åŠŸèƒ½ï¼š

```powershell
# è®°å½•æ¯æ¬¡è¿è¡Œ
$logFile = "commit-history.log"
$logEntry = @"
==========
Time: $(Get-Date)
Branch: $currentBranch
Files Committed: $($Global:CommittedFiles.Count)
Files: $($Global:CommittedFiles -join ", ")
==========
"@
Add-Content -Path $logFile -Value $logEntry
```

------

## æ›´æ–°æ—¥å¿—

### V2.6 (å½“å‰ç‰ˆæœ¬)

- âœ¨ ä¿®å¤å•æ–‡ä»¶æ˜¾ç¤ºé—®é¢˜
- âœ¨ å¢å¼ºè·¯å¾„å¼•å·å¤„ç†
- âœ¨ ä¿®å¤å­—ç¬¦è½¬ä¹‰è¯­æ³•é”™è¯¯
- âœ¨ æ”¹è¿›é”™è¯¯å¤„ç†æœºåˆ¶

### V2.5

- âœ¨ ä¿®å¤ä¸­æ–‡è·¯å¾„è§£æ
- âœ¨ å¢åŠ æ–‡ä»¶é—æ¼æ£€æµ‹
- âœ¨ æ”¹è¿›è·¯å¾„å¤„ç†é€»è¾‘

### V2.4

- âœ¨ å½»åº•ä¿®å¤ä¸­æ–‡æ–‡ä»¶å
- âœ¨ å¢åŠ é—æ¼æ£€æµ‹è­¦å‘Š
- âœ¨ æ”¹è¿›æ•°ç»„å¤„ç†

### V2.3

- âœ¨ ä¿®å¤é€€å‡ºé€»è¾‘
- âœ¨ æ”¹è¿›æ–‡ä»¶è§£æ
- âœ¨ å¢åŠ æ‰‹åŠ¨é€€å‡ºç¡®è®¤

------

## æ”¯æŒä¸åé¦ˆ

### è·å–å¸®åŠ©

1. **æŸ¥çœ‹å†…ç½®å¸®åŠ©**:

   ```powershell
   Get-Help .\interactive-commit.ps1 -Full
   ```

2. **è°ƒè¯•æ¨¡å¼**:

   ```powershell
   # æŸ¥çœ‹è¯¦ç»†è¾“å‡º
   $VerbosePreference = "Continue"
   .\interactive-commit.ps1
   ```

3. **é”™è¯¯è¯Šæ–­**:

   ```powershell
   # æ•è·å®Œæ•´é”™è¯¯
   .\interactive-commit.ps1 2>&1 | Tee-Object -FilePath error.log
   ```

------

## é™„å½•

### A. Git çŠ¶æ€ç å¯¹ç…§è¡¨

| çŠ¶æ€ | å«ä¹‰              | XY æ ¼å¼ |
| ---- | ----------------- | ------- |
| `??` | æœªè·Ÿè¸ª            | `??`    |
| `A ` | å·²æš‚å­˜ï¼ˆæ–°å¢ï¼‰    | `A `    |
| ` M` | å·¥ä½œåŒºä¿®æ”¹        | ` M`    |
| `M ` | æš‚å­˜åŒºä¿®æ”¹        | `M `    |
| `MM` | æš‚å­˜+å·¥ä½œåŒºéƒ½ä¿®æ”¹ | `MM`    |
| `D ` | å·²åˆ é™¤ï¼ˆæš‚å­˜ï¼‰    | `D `    |
| ` D` | å·¥ä½œåŒºåˆ é™¤        | ` D`    |
| `R ` | é‡å‘½å            | `R `    |
| `C ` | å¤åˆ¶              | `C `    |
| `U ` | æœªåˆå¹¶            | `UU`    |

### B. å¿«æ·é”®å‚è€ƒ

| æ“ä½œ         | æŒ‰é”®               |
| ------------ | ------------------ |
| é€€å‡ºå½“å‰è¾“å…¥ | `Ctrl+C`           |
| æ¸…ç©ºè¾“å…¥     | `Esc`              |
| å†å²å‘½ä»¤     | `â†‘` / `â†“`          |
| ç²˜è´´         | `å³é”®` æˆ– `Ctrl+V` |

### C. ç›¸å…³èµ„æº

- [Git å®˜æ–¹æ–‡æ¡£](https://git-scm.com/doc)
- [PowerShell æ–‡æ¡£](https://docs.microsoft.com/powershell)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/)
- [çº¦å®šå¼æäº¤](https://www.conventionalcommits.org/)

------

## è®¸å¯ä¸å£°æ˜

æœ¬è„šæœ¬ä¸ºå¼€æºå·¥å…·ï¼Œå¯è‡ªç”±ä¿®æ”¹å’Œåˆ†å‘ã€‚ä½¿ç”¨æ—¶è¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

- âœ… ä¸ªäººå’Œå•†ä¸šé¡¹ç›®å‡å¯å…è´¹ä½¿ç”¨
- âœ… å¯æ ¹æ®éœ€æ±‚è‡ªç”±ä¿®æ”¹
- âœ… å»ºè®®ä¿ç•™åŸä½œè€…ä¿¡æ¯
- âŒ ä¸æä¾›ä»»ä½•å½¢å¼çš„æ‹…ä¿
- âŒ ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…é£é™©

------

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
 **æœ€åæ›´æ–°**: 2025å¹´12æœˆ

------

ğŸ’¡ **æç¤º**: æŒ‰ `Ctrl+F` æœç´¢å…³é”®è¯å¿«é€Ÿå®šä½é—®é¢˜è§£å†³æ–¹æ¡ˆï¼









## ä¸€ã€é¡¹ç›®è§£å†³çš„ç—›ç‚¹

åœ¨çœŸå®å¼€å‘é‡Œï¼Œæœ€å®¹æ˜“ç¿»è½¦çš„åœºæ™¯ä¹‹ä¸€å°±æ˜¯ï¼š**ä¸€æ¬¡æ”¹åŠ¨å¤ªå¤šæ–‡ä»¶ï¼Œæäº¤åˆä¸æƒ³â€œä¸€é”…ç«¯â€**ã€‚

æ¯”å¦‚ä½ ä»Šå¤©åŒæ—¶æ”¹äº†ï¼šä¸šåŠ¡ä»£ç ã€æµ‹è¯•ã€æ–‡æ¡£ã€é…ç½®ã€ä¸´æ—¶æ–‡ä»¶â€¦â€¦`git status` ä¸€çœ‹å‡ åä¸ªå˜æ›´ã€‚æ¥ä¸‹æ¥ä¼šå‡ºç°ä¸€å †å¸¸è§ç—›ç‚¹ï¼š

- **åˆ†æ‰¹æäº¤å¾ˆéº»çƒ¦**ï¼šéœ€è¦åå¤ `git add <file>`ï¼Œæ–‡ä»¶å¤šæ—¶æ“ä½œæœºæ¢°ä¸”è€—æ—¶
- **å®¹æ˜“è¯¯æäº¤æ•æ„Ÿä¿¡æ¯**ï¼š`.env`ã€tokenã€å¯†é’¥ã€ç”Ÿäº§é…ç½®ä¸€ä¸å°å¿ƒå°±è¿›ä»“åº“ï¼ˆç”šè‡³è¢« push ä¸Šè¿œç«¯ï¼‰
- **å®¹æ˜“æ¼æäº¤**ï¼šæäº¤å®Œä»¥ä¸ºâ€œéƒ½å¥½äº†â€ï¼Œç»“æœè¿˜æœ‰æ–‡ä»¶æ²¡ commitï¼Œpush åæ‰å‘ç°æ”¹åŠ¨æ²¡ä¸Šå»
- **åˆ†æ”¯é£é™©**ï¼šäººåœ¨ `main/master` ä¸Šæ²¡æ³¨æ„å°±ç›´æ¥ commitï¼Œåç»­ PR/å›æ»šéƒ½æ›´éº»çƒ¦
- **ä»“åº“çŠ¶æ€ä¸å®‰å…¨**ï¼šmerge/rebase è¿‡ç¨‹ä¸­è¯¯æ“ä½œæäº¤ï¼Œä¼šæŠŠå†å²æä¹±ï¼Œæ’æŸ¥æˆæœ¬æé«˜

è¿™ä¸ªè„šæœ¬çš„ä»·å€¼å°±æ˜¯æŠŠè¿™äº›é£é™©å’Œé‡å¤åŠ³åŠ¨â€œæµç¨‹åŒ–â€ï¼š**äº¤äº’å¼é€‰æ–‡ä»¶ â†’ åˆ†æ‰¹ commit â†’ æ¼é¡¹æé†’ â†’ æ¨é€å‰äºŒæ¬¡æ£€æŸ¥ â†’ å…³é”®é£é™©æ‹¦æˆª/è­¦å‘Š**ï¼Œè®©æäº¤è¿™ä»¶äº‹æ›´å¯æ§ã€æ›´å®‰å…¨ã€‚



> ## æ³¨ï¼šæœ¬é¡¹ç›®å€ŸåŠ©AIå·¥å…·å®Œæˆ

é¡¹ç›®å®Œæ•´æç¤ºè¯å¦‚ä¸‹ï¼š

### 1.1é¡¹ç›®AIå®Œæ•´æç¤ºè¯

```
## PowerShell äº¤äº’å¼åˆ†æ‰¹æäº¤ GitHub æç¤ºè¯ï¼ˆå®Œæ•´è§„æ ¼ï¼‰

ä½ æ˜¯ä¸€ä¸ªèµ„æ·± DevOps/Windows è‡ªåŠ¨åŒ–å·¥ç¨‹å¸ˆã€‚è¯·ç”¨ **PowerShellï¼ˆps1ï¼‰** ç¼–å†™ä¸€ä¸ª **äº¤äº’å¼ Git æäº¤è„šæœ¬**ï¼Œç”¨äºæŠŠæœ¬åœ°å¤šæ–‡ä»¶æ”¹åŠ¨æŒ‰ç”¨æˆ·é€‰æ‹©åˆ†æ‰¹æäº¤ï¼Œå¹¶æœ€ç»ˆæ¨é€åˆ° GitHubã€‚è„šæœ¬å¿…é¡»ç¨³å¥ã€å¯è¯»ã€å¯ç»´æŠ¤ï¼Œå¹¶å¯¹å¸¸è§é£é™©åšé˜²æŠ¤ã€‚

### 1. è¿è¡Œç¯å¢ƒä¸çº¦æŸ

- è¿è¡Œç¯å¢ƒï¼šWindows PowerShell 5.1 æˆ– PowerShell 7+
- å‡è®¾ç”¨æˆ·å·²å®‰è£… Gitï¼Œå¹¶ä¸” `git` å‘½ä»¤åœ¨ PATH ä¸­
- **ç¦æ­¢**ä¾èµ–ç¬¬ä¸‰æ–¹ PowerShell æ¨¡å—ï¼ˆä»…ç”¨ç³»ç»Ÿè‡ªå¸¦èƒ½åŠ› + git å‘½ä»¤ï¼‰
- è„šæœ¬é»˜è®¤åœ¨å½“å‰ç›®å½•è¿è¡Œï¼Œä½†å¿…é¡»èƒ½è‡ªåŠ¨å®šä½ä»“åº“æ ¹ç›®å½•ï¼ˆæˆ–è‡³å°‘æç¤ºç”¨æˆ·è¿›å…¥ä»“åº“åå†è¿è¡Œï¼‰

------

### 2. å¯åŠ¨å‰æ£€æŸ¥ï¼ˆå¿…é¡»ï¼‰

è„šæœ¬å¯åŠ¨åå¿…é¡»æ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼Œä»»ä½•ä¸€é¡¹å¤±è´¥éƒ½è¦åœæ­¢å¹¶ç»™å‡ºå¯è¯»æç¤ºï¼š

1. **æ˜¯å¦åœ¨ git ä»“åº“å†…**

- ä½¿ç”¨ `git rev-parse --is-inside-work-tree`

1. **æ£€æµ‹æ˜¯å¦å­˜åœ¨æœªå®Œæˆçš„ git æ“ä½œ**

- rebase/merge/cherry-pick ç­‰è¿›è¡Œä¸­åº”ç›´æ¥é˜»æ­¢è„šæœ¬ç»§ç»­
- æ£€æµ‹æ–¹æ³•ï¼ˆä»»é€‰å…¶ä¸€ï¼‰ï¼š
  - æ£€æŸ¥ `.git` ä¸‹ç›¸å…³æ–‡ä»¶ï¼š`MERGE_HEAD` / `CHERRY_PICK_HEAD` / `rebase-apply` / `rebase-merge`
  - æˆ– git å‘½ä»¤æ£€æµ‹çŠ¶æ€ï¼ˆä½†ä¸è¦è§£æäººç±»è¾“å‡ºï¼‰

1. **æ˜¾ç¤ºå½“å‰åˆ†æ”¯ã€è¿œç«¯ä¿¡æ¯**

- æ˜¾ç¤º `git branch --show-current`
- æ˜¾ç¤º `git remote -v`

1. **ä¸»åˆ†æ”¯ä¿æŠ¤ï¼ˆå¯é…ç½®ï¼‰**

- è‹¥å½“å‰åˆ†æ”¯ä¸º `main` æˆ– `master`ï¼Œé»˜è®¤ç»™å‡ºå¼ºæé†’ï¼š
  - å…è®¸ç»§ç»­ï¼Œä½†å¿…é¡»äºŒæ¬¡ç¡®è®¤ï¼ˆè¾“å…¥ YES æ‰èƒ½ç»§ç»­ï¼‰ï¼Œä»¥é˜²è¯¯åœ¨ä¸»åˆ†æ”¯ä¸Šç›´æ¥æäº¤
- æ”¯æŒé€šè¿‡è„šæœ¬é¡¶éƒ¨å˜é‡é…ç½®æ˜¯å¦å…è®¸ä¸»åˆ†æ”¯ç›´æ¥æäº¤

------

### 3. è·å–å˜æ›´æ–‡ä»¶åˆ—è¡¨ï¼ˆå¿…é¡»ç”¨æœºå™¨å¯è§£æè¾“å‡ºï¼‰

- ä¸èƒ½è§£ææ™®é€š `git status` çš„äººç±»æ–‡æœ¬è¾“å‡º
- å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ä¹‹ä¸€ï¼š
  - `git status --porcelain=v1 -z`ï¼ˆä¼˜å…ˆæ¨èï¼Œèƒ½å¤„ç†ç©ºæ ¼/ä¸­æ–‡è·¯å¾„ï¼‰
- æ–‡ä»¶åˆ—è¡¨éœ€åŒ…å«ï¼š
  - æœªè·Ÿè¸ªï¼ˆ??ï¼‰
  - å·²ä¿®æ”¹ï¼ˆMï¼‰
  - æ–°å¢ï¼ˆAï¼‰
  - åˆ é™¤ï¼ˆDï¼‰
  - é‡å‘½åï¼ˆRï¼‰â€”â€”å¦‚å‡ºç°é‡å‘½åï¼Œéœ€ä»¥â€œæ–°è·¯å¾„â€ä¸ºæäº¤å¯¹è±¡ï¼Œå¹¶åœ¨å±•ç¤ºæ—¶æç¤º old -> new

------

### 4. äº¤äº’å¼æ˜¾ç¤ºä¸é€‰æ‹©ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

1. å°†æ‰€æœ‰å¾…å¤„ç†å˜æ›´æŒ‰ç¼–å·æ‰“å°ï¼Œä¾‹å¦‚ï¼š

- `[1] M docs/index.md`
- `[2] ?? src/new file.txt`
- `[3] D old/removed.md`
- `[4] R old/name.md -> new/name.md`

1. æç¤ºç”¨æˆ·è¾“å…¥è¦æäº¤çš„ç¼–å·ï¼ˆæ”¯æŒå¤šé€‰ï¼‰

- æ ¼å¼ï¼š`1 2 5`ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰
- å¯¹éæ³•ç¼–å·ã€é‡å¤ç¼–å·ã€ç©ºè¾“å…¥è¦æœ‰æç¤ºå¹¶é‡æ–°è¾“å…¥
- æä¾›ç‰¹æ®ŠæŒ‡ä»¤ï¼š
  - `q` é€€å‡ºè„šæœ¬ï¼ˆä¸åš pushï¼‰
  - `r` åˆ·æ–°æ–‡ä»¶åˆ—è¡¨
  - `a` é€‰æ‹©å…¨éƒ¨ï¼ˆå¯é€‰ä½†å»ºè®®ï¼‰

1. **ç›®å½•å¤„ç†è¦æ±‚**

- å¦‚æœç”¨æˆ·é€‰æ‹©é¡¹ä¸­åŒ…å«â€œç›®å½•è·¯å¾„â€ï¼ˆPathType=Containerï¼‰ï¼š
  - å¿…é¡»å¿½ç•¥è¯¥é¡¹
  - è¾“å‡ºæé†’ï¼šâ€œæ£€æµ‹åˆ°ç›®å½• xxxï¼Œå·²å¿½ç•¥ï¼›ç›®å½•è¯·è‡ªè¡Œå•ç‹¬æäº¤â€
- è¯´æ˜ï¼šå³ä¾¿ `git status` å¤šæ•°æƒ…å†µä¸‹è¿”å›æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿè¦è€ƒè™‘ç”¨æˆ·è¾“å…¥å¯èƒ½åŒ…å«ç›®å½•ã€å­æ¨¡å—ã€æˆ–è·¯å¾„å¼‚å¸¸

------

### 5. æš‚å­˜è¡Œä¸ºï¼ˆå¿…é¡»ï¼‰

- å¯¹ç”¨æˆ·æœ¬è½®é€‰æ‹©çš„æ¯ä¸ªè·¯å¾„æ‰§è¡Œæš‚å­˜æ“ä½œ
- å¿…é¡»èƒ½æ­£ç¡®å¤„ç†åˆ é™¤/é‡å‘½å/æ–°å¢ç­‰æƒ…å†µï¼Œå»ºè®®ç”¨ï¼š
  - `git add -A -- <path>`
- æš‚å­˜åå¿…é¡»æ‰“å°ä¸€æ¬¡çŠ¶æ€ç¡®è®¤ï¼š
  - `git status`ï¼ˆå¯è¯»è¾“å‡ºå³å¯ï¼‰ï¼Œå¹¶çªå‡ºæ˜¾ç¤º staged çŠ¶æ€

------

### 6. Commit è¡Œä¸ºï¼ˆå¿…é¡»ï¼‰

- æš‚å­˜ç¡®è®¤åï¼Œæç¤ºç”¨æˆ·è¾“å…¥ commit message
- commit message ä¸èƒ½ä¸ºç©ºï¼›ä¸ºç©ºåˆ™å–æ¶ˆæœ¬è½® commitï¼ˆä½†è¦æç¤ºæš‚å­˜åŒºå¯èƒ½å·²å˜åŒ–ï¼‰
- æ”¯æŒâ€œä¸€æ¬¡æäº¤å¤šä¸ªæ–‡ä»¶ä½¿ç”¨åŒä¸€ä¸ª commit messageâ€
- commit æ‰§è¡Œï¼š
  - `git commit -m "<message>"`
- commit æˆåŠŸåå¿…é¡»è¾“å‡ºï¼š
  - æœ¬æ¬¡ commit çš„ç®€è¦ä¿¡æ¯ï¼ˆhashã€æ ‡é¢˜ï¼‰
  - æœ¬æ¬¡ commit åŒ…å«å“ªäº›æ–‡ä»¶ï¼ˆä¾‹å¦‚ `git show --name-only --oneline -1`ï¼‰

------

### 7. å¾ªç¯æœºåˆ¶ï¼ˆå¿…é¡»ï¼‰

- å®Œæˆä¸€æ¬¡ commit åï¼Œè‡ªåŠ¨å›åˆ°â€œæ–‡ä»¶åˆ—è¡¨å±•ç¤ºä¸é€‰æ‹©â€æ­¥éª¤
- ç›´åˆ°ï¼š
  - å·¥ä½œåŒºæ— å¯æäº¤å˜æ›´ï¼ˆè„šæœ¬æç¤º Done å¹¶è¿›å…¥ push é˜¶æ®µï¼‰ï¼Œæˆ–
  - ç”¨æˆ·è¾“å…¥ `q` é€€å‡º

------

### 8. Push è¡Œä¸ºï¼ˆå¿…é¡»ä¸”è¦å®‰å…¨ï¼‰

- ä¸è¦å†™æ­» `git push origin main`ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½åœ¨ feature åˆ†æ”¯ä¸Š
- é»˜è®¤æ¨é€ç­–ç•¥ï¼š
  1. è·å–å½“å‰åˆ†æ”¯å `branch`
  2. å¦‚æœè¯¥åˆ†æ”¯å°šæœªè®¾ç½® upstreamï¼Œåˆ™ä½¿ç”¨ï¼š
     - `git push -u origin <branch>`
  3. è‹¥å·²è®¾ç½® upstreamï¼Œåˆ™ï¼š
     - `git push`
- ä»…å½“å½“å‰åˆ†æ”¯å°±æ˜¯ `main`ï¼ˆæˆ–ç”¨æˆ·æ˜ç¡®é€‰æ‹©â€œæ¨ mainâ€ï¼‰æ—¶ï¼Œæ‰å…è®¸ `git push origin main`
- push å‰å¿…é¡»äºŒæ¬¡ç¡®è®¤ï¼ˆy/nï¼‰

------

### 9. æ—¥å¿—ä¸ç»“æœè¾“å‡ºï¼ˆå¿…é¡»ï¼‰

- æ¯è½®æ“ä½œéƒ½è¦æœ‰æ˜ç¡®æç¤ºï¼ˆæ­£åœ¨åšä»€ä¹ˆã€ç”¨ä»€ä¹ˆå‘½ä»¤ã€ç»“æœå¦‚ä½•ï¼‰
- è„šæœ¬æœ€åå¿…é¡»ï¼š
  - æ‰§è¡Œå¹¶æ‰“å° `git status` æœ€ç»ˆçŠ¶æ€
  - è¾“å‡ºä¸€å¥æ€»ç»“ï¼š
    - `xxxè·¯å¾„/xxxæ–‡ä»¶å·²æäº¤`ï¼ˆåˆ—å‡ºæœ¬æ¬¡è„šæœ¬ä¼šè¯ä¸­æäº¤è¿‡çš„æ–‡ä»¶æ¸…å•ï¼Œå»é‡æ’åºï¼‰
  - è‹¥æœª pushï¼Œä¹Ÿè¦æ˜ç¡®æç¤ºâ€œæœ¬æ¬¡æœªæ¨é€åˆ°è¿œç«¯â€

------

### 10. é”™è¯¯å¤„ç†ï¼ˆå¿…é¡»ï¼‰

- æ¯æ¡ git å‘½ä»¤éƒ½è¦æ£€æŸ¥é€€å‡ºç 
- ä»»æ„å…³é”®æ­¥éª¤å¤±è´¥ï¼ˆadd/commit/pushï¼‰å¿…é¡»ï¼š
  - æ‰“å° stderr
  - åœæ­¢åç»­æ­¥éª¤ï¼ˆä¸è¦ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ­¥ï¼‰
- å¯¹å¯èƒ½å¯¼è‡´ä»“åº“æ··ä¹±çš„åœºæ™¯è¦åœæ­¢å¹¶æç¤ºï¼š
  - merge/rebase è¿›è¡Œä¸­
  - æ²¡æœ‰ä»»ä½•å˜æ›´
  - ç”¨æˆ·è¾“å…¥æ— æ•ˆ

------

### 11. å®‰å…¨é˜²æŠ¤ï¼ˆå¼ºçƒˆå»ºè®®å®ç°ï¼‰

1. **æ•æ„Ÿæ–‡ä»¶æ£€æµ‹**

- è‹¥ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶åŒ¹é…ä»¥ä¸‹æ¨¡å¼ï¼Œè¾“å‡ºé«˜äº®è­¦å‘Šå¹¶è¦æ±‚å†æ¬¡ç¡®è®¤æ‰èƒ½ç»§ç»­æš‚å­˜ï¼š
  - `.env`ã€`*.key`ã€`id_rsa`ã€`secrets.*`ã€`credentials*`ã€`config.prod*`
- åªè­¦å‘Šä¸è‡ªåŠ¨é˜»æ­¢ï¼ˆå¯é…ç½®ï¼‰

1. **å¤§æ–‡ä»¶æé†’**

- è‹¥æ–‡ä»¶å¤§å°è¶…è¿‡é˜ˆå€¼ï¼ˆä¾‹å¦‚ 50MBï¼‰ï¼Œè­¦å‘Šå¯èƒ½ push å¤±è´¥æˆ–ä¸é€‚åˆè¿› git

------

### 12. äº¤äº’ä½“éªŒè¦æ±‚ï¼ˆå»ºè®®ï¼‰

- è¾“å‡ºè¦æ¸…æ™°ã€åˆ†æ®µã€å°½é‡å°‘å™ªéŸ³
- å¯¹æ¯ä¸€æ­¥ç»™ç”¨æˆ·æ˜ç¡®ä¸‹ä¸€æ­¥æ“ä½œæç¤º
- å…è®¸ `Ctrl+C` å®‰å…¨ä¸­æ–­ï¼ˆæç¤ºå¯èƒ½äº§ç”Ÿçš„æš‚å­˜å½±å“ï¼‰

------

### 13. äº¤ä»˜å½¢å¼

- è¾“å‡ºä¸€ä¸ª `.ps1` æ–‡ä»¶å†…å®¹
- è„šæœ¬å¼€å¤´å†™æ˜ï¼š
  - ä½¿ç”¨æ–¹æ³•ï¼ˆå¦‚ä½•è¿è¡Œã€æ˜¯å¦éœ€è¦æ‰§è¡Œç­–ç•¥ï¼‰
  - å¯é…ç½®å‚æ•°ï¼ˆæ˜¯å¦å…è®¸ main æäº¤ã€æ•æ„Ÿæ–‡ä»¶è§„åˆ™ã€å¤§å°é˜ˆå€¼ã€æ˜¯å¦è‡ªåŠ¨ pushï¼‰

------

## ä¸»è¦é£é™©ç‚¹

- æ¨é€å†™æ­» main ä¼šè¯¯æ¨/æ¨ä¸å‡ºå»ï¼ˆå¿…é¡»æ”¹ä¸ºæ¨å½“å‰åˆ†æ”¯ï¼‰
- åˆ†æ‰¹æŒ‰æ–‡ä»¶æäº¤å¯èƒ½æŠŠä¸€ä¸ªåŠŸèƒ½æ‹†æˆå¤šä¸ª commitï¼Œå†å²å¯è¯»æ€§å·®ï¼ˆéœ€è¦æé†’â€œåŒä¸€é€»è¾‘å°½é‡åŒä¸€æ¬¡æäº¤â€ï¼‰
- åˆ é™¤/é‡å‘½åå¦‚æœåªç”¨ `git add file` å¯èƒ½æš‚å­˜ä¸å®Œæ•´ï¼ˆç”¨ `git add -A -- path`ï¼‰
- è§£ææ™®é€š `git status` ä¼šè¢«ç©ºæ ¼/ä¸­æ–‡è·¯å¾„/é‡å‘½åæ ¼å¼å‘ï¼ˆå¿…é¡»ç”¨ `--porcelain -z`ï¼‰
- rebase/merge è¿›è¡Œä¸­æäº¤ä¼šè®©ä»“åº“æ›´ä¹±ï¼ˆå¿…é¡»é˜»æ­¢ï¼‰
```





<a id="script-files"></a>

### 1.2 è„šæœ¬å®Œæ•´æ–‡ä»¶

```powershell
<#
.SYNOPSIS
    äº¤äº’å¼ Git åˆ†æ‰¹æäº¤åŠ©æ‰‹ (V2.6 - ç¨³å®šè¿è¡Œç‰ˆ)
    ä¿®å¤å†…å®¹ï¼š
    1. ä¿®å¤å•æ–‡ä»¶æ˜¾ç¤ºé—®é¢˜
    2. ä¿®å¤è·¯å¾„å¼•å·å¤„ç†
    3. ä¿®å¤å­—ç¬¦è½¬ä¹‰è¯­æ³•é”™è¯¯
    æ³¨æ„ï¼šè¯·åŠ¡å¿…å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸º "UTF-8 with BOM" ç¼–ç æ ¼å¼
#>

# -----------------------------------------------------------------------------
# 0. é…ç½®ä¸åˆå§‹åŒ–
# -----------------------------------------------------------------------------

$OutputEncoding = [System.Text.Encoding]::UTF8
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8

$Config = @{
    ProtectMainBranch    = $true
    SensitivePatterns    = @(".env", "*.key", "id_rsa", "secrets.*", "*credentials*", "config.prod*")
    LargeFileThresholdMB = 50
    TargetRepoPath       = "è¿™é‡Œæ”¹æˆä½ çš„gitæœ¬åœ°ä»“åº“"
}

$Global:CommittedFiles = @()
$Global:InitialFileCount = 0

# -----------------------------------------------------------------------------
# 1. è¾…åŠ©å‡½æ•°
# -----------------------------------------------------------------------------

function Write-Log {
    param([string]$Message, [string]$Level = "Info", [switch]$NoNewLine)
    $color = "Cyan"
    switch ($Level) {
        "Success" { $color = "Green" }
        "Warn"    { $color = "Yellow" }
        "Error"   { $color = "Red" }
    }
    $timeStr = (Get-Date -Format "HH:mm:ss")
    Write-Host "[$timeStr] $Message" -ForegroundColor $color -NoNewline:$NoNewLine
}

function Get-GitRoot {
    $root = git rev-parse --show-toplevel 2>$null
    if ($LASTEXITCODE -eq 0 -and $root) { return $root }
    
    if (Test-Path $Config.TargetRepoPath) {
        Push-Location $Config.TargetRepoPath
        try {
            $root = git rev-parse --show-toplevel 2>$null
            if ($LASTEXITCODE -eq 0 -and $root) { return $root }
        } finally {
            Pop-Location
        }
    }
    return $null
}

function Check-GitState {
    $gitDir = git rev-parse --git-dir 2>$null
    if (-not $gitDir) { return $true }

    $blockers = @("MERGE_HEAD", "CHERRY_PICK_HEAD", "REVERT_HEAD", "rebase-apply", "rebase-merge", "BISECT_LOG")
    foreach ($item in $blockers) {
        $lockPath = Join-Path $gitDir $item
        if (Test-Path $lockPath) {
            Write-Log "ä¸¥é‡è­¦å‘Šï¼šæ£€æµ‹åˆ° Git æ­£åœ¨è¿›è¡Œå¤æ‚æ“ä½œ ($item)ã€‚" "Error"
            return $false
        }
    }
    return $true
}

function Parse-GitStatus {
    $rawLines = git -c core.quotepath=false status --porcelain=v1 2>$null
    
    # å¼ºåˆ¶è½¬æ¢ä¸ºæ•°ç»„
    if ($rawLines -is [string]) {
        $rawLines = @($rawLines)
    }
    
    if (-not $rawLines -or $rawLines.Count -eq 0) { 
        return @() 
    }
    
    $results = [System.Collections.ArrayList]@()
    $index = 1
    
    foreach ($line in $rawLines) {
        if ([string]::IsNullOrWhiteSpace($line) -or $line.Length -lt 3) { 
            continue 
        }
        
        try {
            $status = $line.Substring(0, 2)
            $rest   = $line.Substring(3).Trim()
            
            if ([string]::IsNullOrWhiteSpace($rest)) { continue }
            
            # ç§»é™¤ Git æ·»åŠ çš„è·¯å¾„å¼•å·
            if ($rest.StartsWith('"') -and $rest.EndsWith('"') -and $rest.Length -gt 1) {
                $rest = $rest.Substring(1, $rest.Length - 2)
            }
            
            $obj = [PSCustomObject]@{
                Index   = $index
                Status  = $status
                Path    = ""
                OldPath = $null
                Display = ""
                RawLine = $line
            }

            # å¤„ç†é‡å‘½å
            if ($status -match "^R") {
                if ($rest -match '^(.+?)\s+->\s+(.+)$') {
                    $oldPath = $matches[1].Trim()
                    $newPath = $matches[2].Trim()
                    
                    # åˆ†åˆ«å»é™¤å¼•å·
                    if ($oldPath.StartsWith('"') -and $oldPath.EndsWith('"')) {
                        $oldPath = $oldPath.Substring(1, $oldPath.Length - 2)
                    }
                    if ($newPath.StartsWith('"') -and $newPath.EndsWith('"')) {
                        $newPath = $newPath.Substring(1, $newPath.Length - 2)
                    }
                    
                    $obj.OldPath = $oldPath
                    $obj.Path    = $newPath
                    $obj.Display = "$status $oldPath -> $newPath"
                } else {
                    $obj.Path = $rest
                    $obj.Display = "$status $rest"
                }
            } else {
                $obj.Path = $rest
                $obj.Display = "$status $rest"
            }
            
            [void]$results.Add($obj)
            $index++
            
        } catch {
            Write-Host "è­¦å‘Šï¼šæ— æ³•è§£æè¡Œ: $line" -ForegroundColor Yellow
            continue
        }
    }
    
    return $results.ToArray()
}

function Get-SafeCount {
    param($Collection)
    if ($null -eq $Collection) { return 0 }
    if ($Collection -is [array]) { return $Collection.Count }
    if ($Collection -is [System.Collections.ICollection]) { return $Collection.Count }
    return 1
}

function Show-RemainingFilesWarning {
    param([int]$Remaining, [int]$Total, [int]$Committed)
    
    if ($Remaining -gt 0) {
        Write-Host ""
        Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Yellow
        Write-Host "â•‘  âš ï¸  æ³¨æ„ï¼šè¿˜æœ‰ $Remaining ä¸ªæ–‡ä»¶æœªæäº¤ï¼" -ForegroundColor Yellow
        Write-Host "â•‘  ğŸ“Š ç»Ÿè®¡ï¼šåˆå§‹ $Total ä¸ª â†’ å·²æäº¤ $Committed ä¸ª â†’ å‰©ä½™ $Remaining ä¸ª" -ForegroundColor Yellow
        Write-Host "â•‘  ğŸ’¡ å»ºè®®ï¼šè¾“å…¥ [r] åˆ·æ–°åˆ—è¡¨ï¼Œç¡®è®¤æ˜¯å¦è¿˜æœ‰æ–‡ä»¶éœ€è¦å¤„ç†" -ForegroundColor Yellow
        Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Yellow
        Write-Host ""
    }
}

function Get-SafeFullPath {
    param([string]$RepoRoot, [string]$RelativePath)
    
    try {
        # ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé¿å… Join-Path çš„é—®é¢˜
        $sep = [System.IO.Path]::DirectorySeparatorChar
        $cleanRoot = $RepoRoot.TrimEnd(@('\', '/'))
        $cleanRel = $RelativePath.TrimStart(@('\', '/'))
        return "$cleanRoot$sep$cleanRel"
    } catch {
        return $RelativePath
    }
}

# -----------------------------------------------------------------------------
# 2. ä¸»é€»è¾‘
# -----------------------------------------------------------------------------

try {
    Write-Log "æ­£åœ¨åˆå§‹åŒ–..."
    if (-not (Get-Command git -ErrorAction SilentlyContinue)) { 
        throw "æœªæ‰¾åˆ° git å‘½ä»¤ã€‚" 
    }

    $repoRoot = Get-GitRoot
    if (-not $repoRoot) { 
        throw "æœªæ‰¾åˆ°æœ‰æ•ˆçš„ Git ä»“åº“ã€‚" 
    }

    Set-Location $repoRoot
    Write-Log "ä»“åº“æ ¹ç›®å½•: $repoRoot" "Success"

    if (-not (Check-GitState)) { 
        throw "è¯·å…ˆè§£å†³ Git çŠ¶æ€é”é—®é¢˜ã€‚" 
    }

    $currentBranch = git branch --show-current
    if (-not $currentBranch) { 
        $currentBranch = "DETACHED_HEAD" 
    }
    Write-Log "å½“å‰åˆ†æ”¯: $currentBranch" "Info"

    if ($Config.ProtectMainBranch -and ($currentBranch -in "main", "master")) {
        Write-Log "!!! è­¦å‘Šï¼šå½“å‰å¤„äºä¸»åˆ†æ”¯ '$currentBranch' !!!" "Warn"
        $confirm = Read-Host "ç¡®å®šè¦ç»§ç»­æ“ä½œå—ï¼Ÿ(è¾“å…¥ YES ç»§ç»­)"
        if ($confirm -ne "YES") { 
            Write-Log "å·²å–æ¶ˆã€‚" "Info"
            exit 0 
        }
    }

    # è®°å½•åˆå§‹æ–‡ä»¶æ•°
    $initialChanges = Parse-GitStatus
    $Global:InitialFileCount = Get-SafeCount $initialChanges
    Write-Log "æ£€æµ‹åˆ° $Global:InitialFileCount ä¸ªå¾…å¤„ç†æ–‡ä»¶" "Info"

    $doLoop = $true
    while ($doLoop) {
        Write-Host "`n----------------------------------------" -ForegroundColor Gray
        
        $changes = Parse-GitStatus
        $remainingCount = Get-SafeCount $changes
        
        if ($remainingCount -eq 0) {
            Write-Log "âœ“ å·¥ä½œåŒºå¹²å‡€ï¼Œæ‰€æœ‰æ–‡ä»¶å·²å¤„ç†å®Œæ¯•ï¼" "Success"
            break
        }

        # æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
        Write-Host "å¾…å¤„ç†å˜æ›´ (å…± $remainingCount é¡¹)ï¼š" -ForegroundColor Cyan
        
        foreach ($change in $changes) {
            $color = "White"
            if ($change.Status -like "M*") { $color = "Yellow" }
            elseif ($change.Status -like "A*" -or $change.Status -like "??") { $color = "Green" }
            elseif ($change.Status -like "D*") { $color = "Red" }
            elseif ($change.Status -like "R*") { $color = "Magenta" }
            
            Write-Host " [$($change.Index)] $($change.Display)" -ForegroundColor $color
        }

        # æ˜¾ç¤ºè­¦å‘Š
        $committedCount = Get-SafeCount $Global:CommittedFiles
        if ($remainingCount -gt 0 -and $committedCount -gt 0) {
            Show-RemainingFilesWarning -Remaining $remainingCount -Total $Global:InitialFileCount -Committed $committedCount
        }

        Write-Host "`næŒ‡ä»¤: [æ•°å­—]é€‰æ‹© | [a]å…¨é€‰ | [r]åˆ·æ–° | [q]å®Œæˆå¹¶æ¨é€ | [x]å¼ºåˆ¶é€€å‡º" -ForegroundColor White
        $inputStr = Read-Host "è¯·è¾“å…¥"
        
        # å¤„ç†æŒ‡ä»¤
        if ($inputStr -eq 'q') { 
            if ($remainingCount -gt 0) {
                Write-Host "`nâš ï¸  è­¦å‘Šï¼šè¿˜æœ‰ $remainingCount ä¸ªæ–‡ä»¶æœªæäº¤ï¼" -ForegroundColor Yellow
                Write-Host "è¿™äº›æ–‡ä»¶å°†ä¸ä¼šè¢«æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚" -ForegroundColor Yellow
                Write-Host ""
                Write-Host "å‰©ä½™æ–‡ä»¶ï¼š" -ForegroundColor Yellow
                foreach ($c in $changes) {
                    Write-Host "  â€¢ $($c.Path)" -ForegroundColor Yellow
                }
                Write-Host ""
                $confirmQuit = Read-Host "ç¡®è®¤è¦ç»“æŸæäº¤é˜¶æ®µå—ï¼Ÿ(è¾“å…¥ YES ç¡®è®¤ï¼Œå…¶ä»–ä»»æ„é”®è¿”å›)"
                if ($confirmQuit -ne "YES") {
                    Write-Log "å·²å–æ¶ˆï¼Œç»§ç»­å¤„ç†æ–‡ä»¶..." "Info"
                    continue
                }
            }
            Write-Log "ç»“æŸæäº¤é˜¶æ®µï¼Œè¿›å…¥æ¨é€..." "Info"
            break 
        }
        
        if ($inputStr -eq 'x') { 
            Write-Log "å·²å¼ºåˆ¶é€€å‡ºï¼Œæœªæ‰§è¡Œæ¨é€ã€‚" "Warn"
            exit 0 
        }
        
        if ($inputStr -eq 'r') { 
            Write-Log "æ­£åœ¨åˆ·æ–°æ–‡ä»¶åˆ—è¡¨..." "Info"
            continue 
        }
        
        # é€‰æ‹©æ–‡ä»¶
        $selectedFiles = @()
        if ($inputStr -eq 'a') {
            $selectedFiles = $changes
            $selectCount = Get-SafeCount $selectedFiles
            Write-Log "å·²é€‰æ‹©å…¨éƒ¨ $selectCount ä¸ªæ–‡ä»¶" "Info"
        } else {
            $indices = $inputStr -split "[,\s]+" | Where-Object { $_ -match "^\d+$" }
            foreach ($idx in $indices) {
                $item = $changes | Where-Object { $_.Index -eq [int]$idx }
                if ($item) { $selectedFiles += $item }
            }
        }

        $selectedCount = Get-SafeCount $selectedFiles
        if ($selectedCount -eq 0) { 
            Write-Log "æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶ã€‚" "Warn"
            continue 
        }

        Write-Log "æ­£åœ¨æš‚å­˜ $selectedCount ä¸ªæ–‡ä»¶..."
        $stagedFilesThisRound = @()

        foreach ($file in $selectedFiles) {
            $targetPath = $file.Path
            
            Write-Host "  å¤„ç†: $targetPath" -ForegroundColor Gray
            
            # ä½¿ç”¨å®‰å…¨è·¯å¾„
            $fullPath = Get-SafeFullPath -RepoRoot $repoRoot -RelativePath $targetPath
            
            # ç›®å½•æ£€æŸ¥
            try {
                if (Test-Path -LiteralPath $fullPath -PathType Container -ErrorAction SilentlyContinue) {
                    Write-Log "è·³è¿‡ç›®å½•: $targetPath" "Warn"
                    continue
                }
            } catch {
                # å¿½ç•¥è·¯å¾„æ£€æŸ¥é”™è¯¯
            }

            # æ•æ„Ÿæ–‡ä»¶æ£€æŸ¥
            $isSensitive = $false
            foreach ($p in $Config.SensitivePatterns) {
                $fileName = Split-Path $targetPath -Leaf
                if ($targetPath -like $p -or $fileName -like $p) {
                    $isSensitive = $true
                    break
                }
            }
            if ($isSensitive) {
                Write-Host "!!! æ•æ„Ÿæ–‡ä»¶: $targetPath !!!" -ForegroundColor Red
                if ((Read-Host "ç¡®è®¤æš‚å­˜? (y/n)") -ne 'y') { 
                    continue 
                }
            }

            # å¤§æ–‡ä»¶æ£€æŸ¥
            try {
                if ((Test-Path -LiteralPath $fullPath -ErrorAction SilentlyContinue) -and $file.Status -notlike "D*") {
                    $fileInfo = Get-Item -LiteralPath $fullPath -ErrorAction SilentlyContinue
                    if ($fileInfo -and $fileInfo.Length) {
                        $sizeMB = $fileInfo.Length / 1MB
                        if ($sizeMB -gt $Config.LargeFileThresholdMB) {
                            $sizeStr = "{0:N2} MB" -f $sizeMB
                            Write-Log "å¤§æ–‡ä»¶è­¦å‘Š: $targetPath ($sizeStr)" "Warn"
                        }
                    }
                }
            } catch {
                # å¿½ç•¥å¤§å°æ£€æŸ¥é”™è¯¯
            }

            # æ‰§è¡Œ git add
            $err = & git add -v -- $targetPath 2>&1
            if ($LASTEXITCODE -eq 0) {
                $stagedFilesThisRound += $file
                Write-Host "  âœ“ $targetPath" -ForegroundColor Green
            } else {
                Write-Log "æš‚å­˜å¤±è´¥: $targetPath" "Error"
                Write-Host "  Git é”™è¯¯: $err" -ForegroundColor Red
            }
        }

        $stagedCount = Get-SafeCount $stagedFilesThisRound
        if ($stagedCount -eq 0) { 
            Write-Log "æœ¬è½®æ²¡æœ‰æˆåŠŸæš‚å­˜ä»»ä½•æ–‡ä»¶ã€‚" "Warn"
            continue 
        }

        Write-Host "`nå½“å‰æš‚å­˜åŒºçŠ¶æ€:" -ForegroundColor Green
        git status --short

        $msg = Read-Host "`nCommit Message (ç•™ç©ºå–æ¶ˆæœ¬æ¬¡æäº¤)"
        if ([string]::IsNullOrWhiteSpace($msg)) { 
            Write-Log "å·²å–æ¶ˆæäº¤ã€‚" "Warn"
            Write-Log "æ­£åœ¨æ’¤é”€æš‚å­˜..." "Info"
            git reset HEAD
            continue 
        }

        & git commit -m "$msg"
        if ($LASTEXITCODE -eq 0) {
            Write-Log "âœ“ Commit æˆåŠŸï¼" "Success"
            foreach ($f in $stagedFilesThisRound) {
                if ($f.Path -notin $Global:CommittedFiles) { 
                    $Global:CommittedFiles += $f.Path 
                }
            }
        } else {
            Write-Log "Commit å¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯ã€‚" "Error"
        }
    }

    # ========== æ¨é€é˜¶æ®µ ==========
    Write-Host "`n========================================"
    Write-Host "è¿›å…¥æ¨é€é˜¶æ®µ..." -ForegroundColor Cyan
    Write-Host "========================================"
    
    # æœ€åæ£€æŸ¥é—æ¼æ–‡ä»¶
    $finalCheck = Parse-GitStatus
    $finalCount = Get-SafeCount $finalCheck
    
    if ($finalCount -gt 0) {
        Write-Host ""
        Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Red
        Write-Host "â•‘  âŒ å‘ç°é—æ¼æ–‡ä»¶ï¼" -ForegroundColor Red
        Write-Host "â•‘  ä»¥ä¸‹ $finalCount ä¸ªæ–‡ä»¶æœªè¢«æäº¤ï¼š" -ForegroundColor Red
        Write-Host "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£" -ForegroundColor Red
        foreach ($f in $finalCheck) {
            Write-Host "â•‘    â€¢ $($f.Path)" -ForegroundColor Red
        }
        Write-Host "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£" -ForegroundColor Red
        Write-Host "â•‘  å»ºè®®è¿”å›å¤„ç† (è¾“å…¥ n è¿”å›)" -ForegroundColor Red
        Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Red
        Write-Host ""
        
        $continueWithMissing = Read-Host "ä»ç„¶ç»§ç»­æ¨é€ï¼Ÿ(y/n)"
        if ($continueWithMissing -ne 'y') {
            Write-Log "å·²å–æ¶ˆã€‚è¯·é‡æ–°è¿è¡Œè„šæœ¬å¤„ç†é—æ¼æ–‡ä»¶ã€‚" "Warn"
            exit 0
        }
    }
    
    $upstream = git rev-parse --abbrev-ref --symbolic-full-name "@{u}" 2>$null
    $shouldPush = $false

    if ($LASTEXITCODE -ne 0) {
        Write-Log "å½“å‰åˆ†æ”¯æ— ä¸Šæ¸¸åˆ†æ”¯ï¼Œéœ€è¦é¦–æ¬¡æ¨é€ã€‚" "Warn"
        $shouldPush = $true
    } else {
        $counts = git rev-list --left-right --count "$upstream...HEAD" 2>$null
        if ($counts -match "(\d+)\s+(\d+)") {
            $behind = [int]$matches[1]
            $ahead  = [int]$matches[2]
            
            if ($behind -gt 0) { 
                Write-Log "âš  æœ¬åœ°è½åè¿œç«¯ $behind ä¸ªæäº¤ï¼Œå»ºè®®å…ˆæ‰§è¡Œ 'git pull'ã€‚" "Error" 
                $shouldPush = $false
            }
            elseif ($ahead -gt 0) { 
                Write-Log "æœ‰ $ahead ä¸ªæœ¬åœ°æäº¤å¾…æ¨é€ã€‚" "Info"
                $shouldPush = $true 
            }
            else {
                Write-Log "æœ¬åœ°ä¸è¿œç«¯å·²åŒæ­¥ï¼Œæ— éœ€æ¨é€ã€‚" "Success"
                $shouldPush = $false
            }
        }
    }

    if ($shouldPush) {
        Write-Host "`nå‡†å¤‡æ¨é€åˆ°è¿œç¨‹ä»“åº“..." -ForegroundColor Yellow
        
        $pushArgs = @("push")
        if (-not $upstream) { 
            Write-Log "å°†è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯ä¸º: origin/$currentBranch" "Info"
            $pushArgs += @("-u", "origin", $currentBranch)
        }
        
        $confirm = Read-Host "ç¡®è®¤æ¨é€? (y/n)"
        if ($confirm -eq 'y') {
            Write-Log "æ­£åœ¨æ¨é€..." "Info"
            & git @pushArgs
            
            if ($LASTEXITCODE -eq 0) {
                Write-Log "âœ“ æ¨é€æˆåŠŸï¼" "Success"
            } else {
                Write-Log "âœ— æ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–æƒé™ã€‚" "Error"
            }
        } else {
            Write-Log "å·²å–æ¶ˆæ¨é€ã€‚" "Warn"
        }
    }

    # æ˜¾ç¤ºç»Ÿè®¡
    $committedCount = Get-SafeCount $Global:CommittedFiles
    $missedCount = $Global:InitialFileCount - $committedCount
    
    Write-Host "`n========================================" -ForegroundColor Gray
    Write-Host "ğŸ“Š æœ¬æ¬¡ä¼šè¯ç»Ÿè®¡ï¼š" -ForegroundColor Cyan
    Write-Host "  â€¢ åˆå§‹æ–‡ä»¶æ•°ï¼š$Global:InitialFileCount" -ForegroundColor White
    Write-Host "  â€¢ å·²æäº¤æ–‡ä»¶ï¼š$committedCount" -ForegroundColor Green
    Write-Host "  â€¢ é—æ¼æ–‡ä»¶æ•°ï¼š$missedCount" -ForegroundColor $(if ($missedCount -gt 0) { "Red" } else { "Green" })
    
    if ($committedCount -gt 0) {
        Write-Host "`nå·²æäº¤çš„æ–‡ä»¶åˆ—è¡¨ï¼š" -ForegroundColor Cyan
        $Global:CommittedFiles | Sort-Object -Unique | ForEach-Object { 
            Write-Host "  â€¢ $_" -ForegroundColor White
        }
    }
    
    if ($missedCount -gt 0) {
        Write-Host "`nâš ï¸  æé†’ï¼šæœ‰ $missedCount ä¸ªæ–‡ä»¶æœªæäº¤" -ForegroundColor Yellow
    } else {
        Write-Host "`nâœ“ æ‰€æœ‰æ–‡ä»¶éƒ½å·²æˆåŠŸå¤„ç†ï¼" -ForegroundColor Green
    }

} catch {
    Write-Host "`n[è„šæœ¬é”™è¯¯] $_" -ForegroundColor Red
    Write-Host "é”™è¯¯ä½ç½®: $($_.InvocationInfo.ScriptLineNumber) è¡Œ" -ForegroundColor Red
    Write-Host "å †æ ˆä¿¡æ¯: $($_.ScriptStackTrace)" -ForegroundColor Red
}

Write-Host "`næŒ‰ä»»æ„é”®é€€å‡º..." -ForegroundColor Gray
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
```





## äºŒã€âœ… å·²å®Œæ•´å®ç°çš„æ ¸å¿ƒåŠŸèƒ½å¦‚ä¸‹

### 1. **å¯åŠ¨å‰æ£€æŸ¥** âœ… å®Œæ•´å®ç°

- âœ… Git ä»“åº“æ£€æµ‹ï¼ˆ`Get-GitRoot` å‡½æ•°ï¼‰
- âœ… æœªå®Œæˆæ“ä½œæ£€æµ‹ï¼ˆ`Check-GitState` - æ£€æµ‹ MERGE_HEADã€REBASE ç­‰ï¼‰
- âœ… å½“å‰åˆ†æ”¯æ˜¾ç¤º
- âœ… ä¸»åˆ†æ”¯ä¿æŠ¤ï¼ˆéœ€è¾“å…¥ YES ç¡®è®¤ï¼‰
- âŒ **ç¼ºå¤±**ï¼šè¿œç«¯ä¿¡æ¯æ˜¾ç¤ºï¼ˆ`git remote -v`ï¼‰

### 2. **å˜æ›´æ–‡ä»¶åˆ—è¡¨** âœ… å·²å®ç°ä¸”å¢å¼º

- âœ… ä½¿ç”¨ `--porcelain=v1`ï¼ˆæœºå™¨å¯è§£æï¼‰
- âœ… ä½¿ç”¨ `-c core.quotepath=false`ï¼ˆå¤„ç†ä¸­æ–‡ï¼‰
- âœ… æ”¯æŒæ‰€æœ‰çŠ¶æ€ï¼ˆM/A/D/R/??ï¼‰
- âœ… **å¢å¼º**ï¼šè‡ªåŠ¨å»é™¤ Git æ·»åŠ çš„è·¯å¾„å¼•å·
- âš ï¸ **æœªå®Œå…¨ä½¿ç”¨ `-z`**ï¼šè™½ç„¶æåˆ°äº†ï¼Œä½†å®é™…ç”¨çš„æ˜¯æ ‡å‡†è¾“å‡º

### 3. **äº¤äº’å¼é€‰æ‹©** âœ… å®Œæ•´å®ç°ä¸”å¢å¼º

- âœ… ç¼–å·æ˜¾ç¤ºï¼ˆå¸¦é¢œè‰²åŒºåˆ†çŠ¶æ€ï¼‰
- âœ… å¤šé€‰æ”¯æŒï¼ˆç©ºæ ¼/é€—å·åˆ†éš”ï¼‰
- âœ… ç‰¹æ®ŠæŒ‡ä»¤ï¼š`q`/`r`/`a`
- âœ… éæ³•è¾“å…¥å¤„ç†
- âœ… ç›®å½•å¿½ç•¥ï¼ˆå¸¦æç¤ºï¼‰
- âœ… **å¢å¼º**ï¼š`x` å¼ºåˆ¶é€€å‡ºï¼ˆä¸æ¨é€ï¼‰
- âœ… **å¢å¼º**ï¼š`q` æ”¹ä¸ºè¿›å…¥æ¨é€é˜¶æ®µè€Œéç›´æ¥é€€å‡º

### 4. **æš‚å­˜è¡Œä¸º** âœ… å®Œæ•´å®ç°

- âœ… ä½¿ç”¨ `git add -v -- <path>`
- âœ… åˆ é™¤/é‡å‘½åæ­£ç¡®å¤„ç†
- âœ… çŠ¶æ€ç¡®è®¤ï¼ˆ`git status --short`ï¼‰
- âœ… **å¢å¼º**ï¼šé€æ–‡ä»¶æ˜¾ç¤ºæš‚å­˜ç»“æœï¼ˆâœ“ æ ‡è®°ï¼‰

### 5. **Commit è¡Œä¸º** âœ… å®Œæ•´å®ç°ä¸”å¢å¼º

- âœ… æç¤ºè¾“å…¥ message
- âœ… ç©º message æ£€æµ‹
- âœ… Commit æ‰§è¡Œ
- âš ï¸ **æœªå®Œå…¨å®ç°**ï¼šæœªæ˜¾ç¤º `git show --name-only`
- âœ… **å¢å¼º**ï¼šå–æ¶ˆæ—¶è‡ªåŠ¨ `git reset HEAD` æ’¤é”€æš‚å­˜

### 6. **å¾ªç¯æœºåˆ¶** âœ… å®Œæ•´å®ç°

- âœ… è‡ªåŠ¨å›åˆ°æ–‡ä»¶åˆ—è¡¨
- âœ… å·¥ä½œåŒºå¹²å‡€æ—¶è‡ªåŠ¨è¿›å…¥æ¨é€
- âœ… æ”¯æŒ `q` æ‰‹åŠ¨é€€å‡º

### 7. **Push è¡Œä¸º** âœ… å®Œæ•´å®ç°

- âœ… è‡ªåŠ¨æ£€æµ‹å½“å‰åˆ†æ”¯
- âœ… upstream æ£€æµ‹
- âœ… æ—  upstream æ—¶ `-u origin <branch>`
- âœ… äºŒæ¬¡ç¡®è®¤ï¼ˆy/nï¼‰
- âœ… è½åè¿œç«¯æ£€æµ‹

### 8. **æ—¥å¿—è¾“å‡º** âœ… å®Œæ•´å®ç°

- âœ… æ¯æ­¥æ“ä½œéƒ½æœ‰æç¤º
- âœ… æ—¶é—´æˆ³æ—¥å¿—ï¼ˆ`Write-Log` å‡½æ•°ï¼‰
- âœ… æœ€ç»ˆæ–‡ä»¶æ¸…å•

### 9. **é”™è¯¯å¤„ç†** âœ… å®Œæ•´å®ç°

- âœ… æ‰€æœ‰ Git å‘½ä»¤æ£€æŸ¥ `$LASTEXITCODE`
- âœ… Try-Catch åŒ…è£¹
- âœ… è¯¦ç»†é”™è¯¯ä¿¡æ¯è¾“å‡º

### 10. **å®‰å…¨é˜²æŠ¤** âœ… å®Œæ•´å®ç°ä¸”å¢å¼º

- âœ… æ•æ„Ÿæ–‡ä»¶æ£€æµ‹ï¼ˆå¯é…ç½®æ¨¡å¼ï¼‰
- âœ… å¤§æ–‡ä»¶æé†’ï¼ˆ50MB é˜ˆå€¼ï¼‰
- âœ… äºŒæ¬¡ç¡®è®¤æœºåˆ¶

------

## ä¸‰ã€è„šæœ¬çš„åˆ›æ–°å¢å¼ºåŠŸèƒ½

### 1. **æ–‡ä»¶é—æ¼æ£€æµ‹ç³»ç»Ÿ** â­â­â­

```powershell
$Global:InitialFileCount = 0  # è®°å½•åˆå§‹æ–‡ä»¶æ•°
$Global:CommittedFiles = @()  # è·Ÿè¸ªå·²æäº¤æ–‡ä»¶
```

- âœ¨ åˆå§‹åŒ–æ—¶è®°å½•æ€»æ–‡ä»¶æ•°
- âœ¨ æ¯è½® Commit åå®æ—¶ç»Ÿè®¡
- âœ¨ é»„è‰²è­¦å‘Šæ¡†æç¤ºå‰©ä½™æ–‡ä»¶
- âœ¨ æ¨é€å‰çº¢è‰²è­¦å‘Šæ¡†æ£€æŸ¥é—æ¼
- âœ¨ æœ€ç»ˆç»Ÿè®¡æŠ¥å‘Š

### 2. **å¢å¼ºçš„è·¯å¾„å¤„ç†** â­â­

```powershell
# è‡ªåŠ¨å»é™¤ Git æ·»åŠ çš„å¼•å·
if ($rest.StartsWith('"') -and $rest.EndsWith('"')) {
    $rest = $rest.Substring(1, $rest.Length - 2)
}
```

- âœ¨ è§£å†³ä¸­æ–‡æ–‡ä»¶åé—®é¢˜
- âœ¨ å¤„ç†å¸¦ç©ºæ ¼çš„è·¯å¾„
- âœ¨ å®‰å…¨çš„è·¯å¾„æ‹¼æ¥å‡½æ•°

### 3. **æ™ºèƒ½é€€å‡ºæœºåˆ¶** â­â­

- âœ¨ `q` = å®Œæˆæäº¤å¹¶æ¨é€ï¼ˆæ™ºèƒ½ï¼‰
- âœ¨ `x` = å¼ºåˆ¶é€€å‡ºä¸æ¨é€ï¼ˆç´§æ€¥ï¼‰
- âœ¨ æœ‰å‰©ä½™æ–‡ä»¶æ—¶éœ€è¾“å…¥ YES äºŒæ¬¡ç¡®è®¤

### 4. **ä¸°å¯Œçš„è§†è§‰åé¦ˆ** â­

```powershell
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âš ï¸  æ³¨æ„ï¼šè¿˜æœ‰ 1 ä¸ªæ–‡ä»¶æœªæäº¤ï¼
â•‘  ğŸ“Š ç»Ÿè®¡ï¼šåˆå§‹ 10 ä¸ª â†’ å·²æäº¤ 9 ä¸ª â†’ å‰©ä½™ 1 ä¸ª
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

- âœ¨ å½©è‰²çŠ¶æ€ï¼ˆM=é»„/A=ç»¿/D=çº¢/R=ç´«ï¼‰
- âœ¨ æ—¶é—´æˆ³æ—¥å¿—
- âœ¨ Emoji å›¾æ ‡
- âœ¨ è¾¹æ¡†è­¦å‘Š

### 5. **å¥å£®çš„æ•°ç»„å¤„ç†** â­â­

```powershell
function Get-SafeCount {
    # è§£å†³å•æ–‡ä»¶æ—¶ .Count è¿”å›ç©ºçš„é—®é¢˜
}
```

- âœ¨ ä¿®å¤ PowerShell å•å¯¹è±¡è®¡æ•° bug
- âœ¨ å¼ºåˆ¶æ•°ç»„è½¬æ¢

### 6. **å¯é…ç½®æ€§** â­

```powershell
$Config = @{
    ProtectMainBranch    = $true
    SensitivePatterns    = @(...)
    LargeFileThresholdMB = 50
    TargetRepoPath       = "..."
}
```

- âœ¨ é›†ä¸­é…ç½®ç®¡ç†
- âœ¨ æ˜“äºè‡ªå®šä¹‰

------

## å››ã€æœªå®ç°æˆ–éƒ¨åˆ†ç¼ºå¤±çš„åŠŸèƒ½

### 1. **è¿œç«¯ä¿¡æ¯æ˜¾ç¤º**

```powershell
# å»ºè®®è¡¥å……
git remote -v
```

### 2. **Commit è¯¦æƒ…æ˜¾ç¤º**

```powershell
# å»ºè®®è¡¥å……
git show --name-only --oneline -1
```

### 3. **æœªä½¿ç”¨ `-z` å‚æ•°**

- å½“å‰ç”¨æ ‡å‡†è¾“å‡ºï¼Œè™½ç„¶å·²å¤„ç†å¼•å·ï¼Œä½† `-z` æ›´å¯é 

### 4. **Ctrl+C ä¸­æ–­æç¤º**

- æœªå®ç°ä¼˜é›…çš„ä¸­æ–­å¤„ç†

------

## äº”ã€ åŠŸèƒ½å®Œæˆåº¦è¯„ä¼°

| éœ€æ±‚ç±»åˆ«     | å®Œæˆåº¦ | è¯´æ˜                   |
| ------------ | ------ | ---------------------- |
| å¯åŠ¨æ£€æŸ¥     | 90%    | ç¼ºå°‘ remote -v æ˜¾ç¤º    |
| æ–‡ä»¶è§£æ     | 95%    | å·²è¶…é¢„æœŸï¼Œè·¯å¾„å¤„ç†å®Œå–„ |
| äº¤äº’é€‰æ‹©     | 100%   | å®Œæ•´å®ç°ä¸”å¢å¼º         |
| æš‚å­˜è¡Œä¸º     | 100%   | å®Œæ•´å®ç°               |
| Commit       | 95%    | ç¼ºå°‘è¯¦ç»†ä¿¡æ¯å±•ç¤º       |
| å¾ªç¯æœºåˆ¶     | 100%   | å®Œæ•´å®ç°               |
| Push è¡Œä¸º    | 100%   | å®Œæ•´å®ç°               |
| æ—¥å¿—è¾“å‡º     | 100%   | è¶…é¢„æœŸï¼ˆæ—¶é—´æˆ³+ç»Ÿè®¡ï¼‰  |
| é”™è¯¯å¤„ç†     | 100%   | å…¨é¢è¦†ç›–               |
| å®‰å…¨é˜²æŠ¤     | 100%   | å®Œæ•´å®ç°               |
| **é—æ¼æ£€æµ‹** | â­ æ–°å¢ | åŸéœ€æ±‚æœªè¦æ±‚           |
| **è·¯å¾„å¼•å·** | â­ æ–°å¢ | åŸéœ€æ±‚æœªæ¶‰åŠ           |
| **æ™ºèƒ½é€€å‡º** | â­ å¢å¼º | åŸéœ€æ±‚åªè¦æ±‚ q é€€å‡º    |

------

## å…­ã€ è„šæœ¬å½“å‰çŠ¶æ€

### âœ… ä¼˜åŠ¿

1. **åŠŸèƒ½å®Œæ•´åº¦ 97%** - æ ¸å¿ƒéœ€æ±‚å…¨éƒ¨å®ç°
2. **ç”¨æˆ·ä½“éªŒä¼˜ç§€** - è§†è§‰åé¦ˆä¸°å¯Œï¼Œæ“ä½œç›´è§‚
3. **é”™è¯¯å¤„ç†å®Œå–„** - å¤§é‡ try-catch å’Œè¾¹ç•Œå¤„ç†
4. **åˆ›æ–°åŠŸèƒ½** - é—æ¼æ£€æµ‹ç³»ç»Ÿæ˜¯äº®ç‚¹
5. **ä»£ç è´¨é‡é«˜** - å‡½æ•°åŒ–ã€æ³¨é‡Šæ¸…æ™°ã€å¯ç»´æŠ¤

### âš ï¸ éœ€æ”¹è¿›

1. æ·»åŠ  `git remote -v` æ˜¾ç¤º
2. æ·»åŠ  commit è¯¦æƒ…ï¼ˆ`git show`ï¼‰
3. è€ƒè™‘ä½¿ç”¨ `-z` å‚æ•°æé«˜å¥å£®æ€§

### ğŸ’¡ å»ºè®®è¡¥å……

```powershell
# åœ¨å¯åŠ¨æ£€æŸ¥é˜¶æ®µæ·»åŠ 
Write-Host "`nè¿œç¨‹ä»“åº“ä¿¡æ¯:" -ForegroundColor Cyan
git remote -v

# åœ¨ Commit æˆåŠŸåæ·»åŠ 
Write-Host "`næœ¬æ¬¡æäº¤è¯¦æƒ…:" -ForegroundColor Green
git show --name-only --oneline -1
```

------

## ä¸ƒã€ æ€»ç»“

è¿™ä¸ªè„šæœ¬**è¶…é¢å®Œæˆ**äº†åŸå§‹éœ€æ±‚ï¼Œä¸ä»…å®ç°äº†æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ˆ97%ï¼‰ï¼Œè¿˜åˆ›æ–°æ€§åœ°æ·»åŠ äº†ï¼š

- æ–‡ä»¶é—æ¼æ£€æµ‹ä¸ç»Ÿè®¡ç³»ç»Ÿ
- å¢å¼ºçš„è·¯å¾„å¤„ç†ï¼ˆä¸­æ–‡/ç©ºæ ¼/å¼•å·ï¼‰
- æ™ºèƒ½é€€å‡ºæœºåˆ¶
- ä¸°å¯Œçš„è§†è§‰åé¦ˆ

**å¯ä»¥ç›´æ¥æŠ•å…¥ç”Ÿäº§ä½¿ç”¨**ï¼Œåªéœ€æ ¹æ®ä¸ªäººåå¥½è¡¥å…… 2-3 ä¸ªå°åŠŸèƒ½å³å¯å®Œç¾ä½¿ç”¨ï¼











