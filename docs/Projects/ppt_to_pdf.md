##  ç¨‹åºè¯¦ç»†è¯´æ˜

[ç¨‹åºæºç ](#yuanma)

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ **Windows COM æ¥å£**æ§åˆ¶ PowerPoint æ¥æ‰¹é‡è½¬æ¢ PPT/PPTX æ–‡ä»¶ä¸º PDF çš„ Python å·¥å…·ã€‚

---

### ğŸ¯ å®ç°çš„åŠŸèƒ½

| åŠŸèƒ½                 | è¯´æ˜                                                |
| -------------------- | --------------------------------------------------- |
| **æ‰¹é‡è½¬æ¢**         | è‡ªåŠ¨æ‰«ææŒ‡å®šæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰ `.ppt` å’Œ `.pptx` æ–‡ä»¶     |
| **æ ¼å¼æ”¯æŒ**         | åŒæ—¶æ”¯æŒæ—§ç‰ˆ `.ppt` å’Œæ–°ç‰ˆ `.pptx` æ ¼å¼             |
| **è‡ªåŠ¨åˆ›å»ºè¾“å‡ºç›®å½•** | å¦‚æœè¾“å‡ºæ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»º                      |
| **è¿›åº¦æ˜¾ç¤º**         | æ˜¾ç¤ºè½¬æ¢è¿›åº¦ `[å½“å‰/æ€»æ•°]`ï¼Œä¾¿äºè·Ÿè¸ª                |
| **è½¬æ¢ç»Ÿè®¡**         | å®Œæˆåæ±‡æ€»æˆåŠŸå’Œå¤±è´¥çš„æ•°é‡                          |
| **é”™è¯¯å¤„ç†**         | å•ä¸ªæ–‡ä»¶è½¬æ¢å¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªæ‰¹å¤„ç†æµç¨‹              |
| **èµ„æºæ¸…ç†**         | ä½¿ç”¨ `try-finally` ç¡®ä¿ PowerPoint åº”ç”¨ç¨‹åºæ­£ç¡®å…³é—­ |

---

### âœ… ä¼˜ç‚¹

1. **é«˜ä¿çœŸè½¬æ¢**
   - é€šè¿‡ PowerPoint åŸç”Ÿ COM æ¥å£è¿›è¡Œè½¬æ¢ï¼Œç¡®ä¿æ ¼å¼ã€å­—ä½“ã€åŠ¨ç”»æ•ˆæœç­‰100%è¿˜åŸ

2. **ç¨³å®šå¯é **
   - ä½¿ç”¨ `ReadOnly=True` æ‰“å¼€æ–‡ä»¶ï¼Œé¿å…æ„å¤–ä¿®æ”¹åŸæ–‡ä»¶
   - æ·»åŠ  `time.sleep(1)` ç­‰å¾…æ–‡ä»¶å®Œå…¨åŠ è½½ï¼Œå‡å°‘è½¬æ¢é”™è¯¯

3. **å‹å¥½çš„ç”¨æˆ·äº¤äº’**
   - æ¸…æ™°çš„è¿›åº¦æç¤ºï¼ˆâœ“ æˆåŠŸ / âœ— å¤±è´¥ï¼‰
   - ç¨‹åºç»“æŸæ—¶ç­‰å¾…ç”¨æˆ·æŒ‰å›è½¦é€€å‡ºï¼Œä¾¿äºæŸ¥çœ‹ç»“æœ

4. **å®¹é”™æ€§å¼º**
   - å•ä¸ªæ–‡ä»¶å¤±è´¥åç»§ç»­å¤„ç†å…¶ä»–æ–‡ä»¶
   - å®Œå–„çš„å¼‚å¸¸æ•è·æœºåˆ¶

5. **ä»£ç ç®€æ´æ˜“æ‡‚**
   - æ ¸å¿ƒåŠŸèƒ½å°è£…åœ¨å•ä¸€å‡½æ•°ä¸­
   - æ³¨é‡Šè¯¦å°½ï¼Œä¾¿äºç»´æŠ¤å’Œä¿®æ”¹

---

### ğŸ“‹ é€‚ç”¨åœºæ™¯

| åœºæ™¯           | æè¿°                                                         |
| -------------- | ------------------------------------------------------------ |
| **æ•™è‚²é¢†åŸŸ**   | æ•™å¸ˆæ‰¹é‡è½¬æ¢è¯¾ç¨‹ PPT ä¸º PDF ä¾›å­¦ç”Ÿä¸‹è½½ï¼ˆæ­£å¦‚ä»£ç ä¸­çš„ç¤ºä¾‹è·¯å¾„æ‰€ç¤ºï¼‰ |
| **ä¼ä¸šåŠå…¬**   | å°†ä¼šè®®èµ„æ–™ã€åŸ¹è®­ææ–™ç»Ÿä¸€è½¬ä¸º PDF æ ¼å¼ä¾¿äºåˆ†å‘                |
| **å½’æ¡£å­˜å‚¨**   | å°†å¤§é‡æ¼”ç¤ºæ–‡ç¨¿è½¬æ¢ä¸º PDF è¿›è¡Œé•¿æœŸä¿å­˜                        |
| **è·¨å¹³å°åˆ†äº«** | PDF æ ¼å¼å…¼å®¹æ€§æ›´å¥½ï¼Œé€‚åˆåˆ†äº«ç»™æ²¡æœ‰å®‰è£… PowerPoint çš„ç”¨æˆ·     |
| **æ‰“å°å‡†å¤‡**   | PDF æ ¼å¼æ›´é€‚åˆæ‰“å°ï¼Œé¿å…æ’ç‰ˆé”™ä¹±                             |

---

### âš ï¸ ä½¿ç”¨å‰æ

- **å¿…é¡»å®‰è£… Microsoft PowerPoint**ï¼ˆç¨‹åºé€šè¿‡ COM æ¥å£è°ƒç”¨ PowerPointï¼‰
- **ä»…é™ Windows ç³»ç»Ÿ**ï¼ˆä¾èµ– Windows COM æŠ€æœ¯ï¼‰
- éœ€è¦å®‰è£… `comtypes` åº“ï¼š`pip install comtypes`

---

### ğŸ’¡ ä½¿ç”¨æ–¹æ³•

ä¿®æ”¹ç¬¬ 97-98 è¡Œçš„è·¯å¾„å³å¯ï¼š

```python
input_folder = r"ä½ çš„PPTæ–‡ä»¶å¤¹è·¯å¾„"
output_folder = r"ä½ çš„PDFè¾“å‡ºè·¯å¾„"
```

ç„¶åç›´æ¥è¿è¡Œè„šæœ¬å³å¯å®Œæˆæ‰¹é‡è½¬æ¢ï¼



<a id="yuanma"></a>

## ç¨‹åºæºç 

```python
"""
æ‰¹é‡å°†æ–‡ä»¶å¤¹ä¸­çš„PPT/PPTXæ–‡ä»¶è½¬æ¢ä¸ºPDF
ä½¿ç”¨Windows COMæ¥å£æ§åˆ¶PowerPoint
"""
import os
import sys
import time
import comtypes.client

def convert_ppt_to_pdf(input_folder, output_folder):
    """
    å°†input_folderä¸­çš„æ‰€æœ‰PPT/PPTXæ–‡ä»¶è½¬æ¢ä¸ºPDFå¹¶ä¿å­˜åˆ°output_folder
    """
    # ç¡®ä¿è¾“å‡ºæ–‡ä»¶å¤¹å­˜åœ¨
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)
        print(f"åˆ›å»ºè¾“å‡ºæ–‡ä»¶å¤¹: {output_folder}")
    
    # æ”¯æŒçš„PPTæ‰©å±•å
    ppt_extensions = ('.ppt', '.pptx')
    
    # è·å–æ‰€æœ‰PPTæ–‡ä»¶
    ppt_files = [f for f in os.listdir(input_folder) 
                 if f.lower().endswith(ppt_extensions)]
    
    if not ppt_files:
        print("æœªæ‰¾åˆ°ä»»ä½•PPT/PPTXæ–‡ä»¶ï¼")
        return
    
    print(f"æ‰¾åˆ° {len(ppt_files)} ä¸ªPPTæ–‡ä»¶")
    
    # åˆ›å»ºPowerPointåº”ç”¨ç¨‹åºå®ä¾‹
    powerpoint = None
    try:
        powerpoint = comtypes.client.CreateObject("PowerPoint.Application")
        powerpoint.Visible = 1  # è®¾ç½®ä¸ºå¯è§ï¼ˆæœ‰æ—¶å€™ä¸å¯è§ä¼šæœ‰é—®é¢˜ï¼‰
        
        success_count = 0
        fail_count = 0
        
        for i, ppt_file in enumerate(ppt_files, 1):
            input_path = os.path.join(input_folder, ppt_file)
            # è·å–ä¸å¸¦æ‰©å±•åçš„æ–‡ä»¶å
            base_name = os.path.splitext(ppt_file)[0]
            output_path = os.path.join(output_folder, f"{base_name}.pdf")
            
            print(f"[{i}/{len(ppt_files)}] æ­£åœ¨è½¬æ¢: {ppt_file}")
            
            try:
                # æ‰“å¼€PPTæ–‡ä»¶
                # Open(FileName, ReadOnly, Untitled, WithWindow)
                presentation = powerpoint.Presentations.Open(
                    input_path,
                    ReadOnly=True,
                    Untitled=False,
                    WithWindow=False
                )
                
                # ç­‰å¾…ä¸€ä¸‹ç¡®ä¿æ–‡ä»¶å®Œå…¨åŠ è½½
                time.sleep(1)
                
                # ä¿å­˜ä¸ºPDF (32 = ppSaveAsPDF)
                presentation.SaveAs(output_path, 32)
                
                # å…³é—­æ¼”ç¤ºæ–‡ç¨¿
                presentation.Close()
                
                print(f"    âœ“ è½¬æ¢æˆåŠŸ: {base_name}.pdf")
                success_count += 1
                
            except Exception as e:
                print(f"    âœ— è½¬æ¢å¤±è´¥: {str(e)}")
                fail_count += 1
                continue
        
        print("\n" + "="*50)
        print(f"è½¬æ¢å®Œæˆï¼æˆåŠŸ: {success_count}, å¤±è´¥: {fail_count}")
        print(f"PDFæ–‡ä»¶ä¿å­˜åœ¨: {output_folder}")
        
    except Exception as e:
        print(f"åˆå§‹åŒ–PowerPointå¤±è´¥: {str(e)}")
        print("è¯·ç¡®ä¿å·²å®‰è£…Microsoft PowerPoint")
        
    finally:
        # å…³é—­PowerPointåº”ç”¨ç¨‹åº
        if powerpoint:
            try:
                powerpoint.Quit()
            except:
                pass


if __name__ == "__main__":
    # ============================================
    # åœ¨è¿™é‡Œä¿®æ”¹ä½ çš„è¾“å…¥å’Œè¾“å‡ºè·¯å¾„
    # ============================================
    input_folder = r"E:\2025.9.3å¤§ä¸‰ä¸Šå­¦æœŸå®è®­è¯¾\å¤§ä¸‰ä¸‹å­¦æœŸå®éªŒæŠ¥å‘Š2025-9--12\è®¡ç®—æœºç»„æˆåŸç†---ç‹ç\è¯¾ç¨‹PPT\PPT"
    output_folder = r"E:\2025.9.3å¤§ä¸‰ä¸Šå­¦æœŸå®è®­è¯¾\å¤§ä¸‰ä¸‹å­¦æœŸå®éªŒæŠ¥å‘Š2025-9--12\è®¡ç®—æœºç»„æˆåŸç†---ç‹ç\è¯¾ç¨‹PPT\pdf"
    
    # æ£€æŸ¥è¾“å…¥æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨
    if not os.path.exists(input_folder):
        print(f"é”™è¯¯ï¼šè¾“å…¥æ–‡ä»¶å¤¹ä¸å­˜åœ¨: {input_folder}")
        sys.exit(1)
    
    print("="*50)
    print("PPTæ‰¹é‡è½¬PDFå·¥å…·")
    print("="*50)
    print(f"è¾“å…¥æ–‡ä»¶å¤¹: {input_folder}")
    print(f"è¾“å‡ºæ–‡ä»¶å¤¹: {output_folder}")
    print("="*50 + "\n")
    
    convert_ppt_to_pdf(input_folder, output_folder)
    
    input("\næŒ‰å›è½¦é”®é€€å‡º...")

```

