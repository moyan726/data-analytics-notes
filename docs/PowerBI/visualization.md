# Power BI 可视化技巧

创建有效、美观的数据可视化的最佳实践和技巧。

## 选择正确的图表类型

### 比较数据

**柱状图 / 条形图**

- 用途：比较不同类别的数值
- 适用场景：产品销售对比、地区业绩对比

```
最佳实践：
✅ 按数值排序
✅ 使用水平条形图显示长标签
✅ 限制类别数量（10 个以内）
```

**分组柱状图**

- 用途：多维度比较
- 适用场景：按年份和类别对比销售额

### 显示趋势

**折线图**

- 用途：显示数据随时间的变化
- 适用场景：月度销售趋势、股票价格走势

```
最佳实践：
✅ 使用清晰的日期轴
✅ 添加数据标签（当数据点较少时）
✅ 使用不同颜色区分多条线
```

**面积图**

- 用途：显示累计趋势
- 适用场景：市场份额变化

### 显示占比

**饼图 / 环形图**

- 用途：显示部分与整体的关系
- 适用场景：市场份额、预算分配

```
最佳实践：
✅ 限制切片数量（5-7 个）
✅ 按大小排序
❌ 避免 3D 效果
```

**树状图**

- 用途：显示层次结构和占比
- 适用场景：多层次预算分配

### 显示分布

**直方图**

- 用途：显示数据分布
- 适用场景：年龄分布、价格区间分布

**箱线图**

- 用途：显示数据分布和异常值
- 适用场景：销售数据离散程度分析

### 显示关系

**散点图**

- 用途：显示两个变量之间的关系
- 适用场景：价格与销量的关系

```
技巧：
- 添加趋势线
- 使用颜色编码第三个维度
- 使用大小编码第四个维度
```

### 地理数据

**地图**

- 标准地图（Map）
- 着色地图（Filled Map）
- ArcGIS 地图

```
最佳实践：
✅ 确保位置数据准确
✅ 使用合适的缩放级别
✅ 添加工具提示显示详细信息
```

## KPI 和仪表盘

### KPI 卡片

```dax
// 创建 KPI 度量值
Total Sales = SUM(Sales[Amount])

Sales Target = 1000000

Sales vs Target = 
VAR Actual = [Total Sales]
VAR Target = [Sales Target]
RETURN
    DIVIDE(Actual - Target, Target)
```

### 仪表盘（Gauge）

- 显示进度和目标
- 适合单一 KPI 监控

### 多行卡片

- 显示多个关键指标
- 快速概览

## 高级可视化

### 表格和矩阵

**表格**
- 显示详细数据
- 支持排序和筛选

**矩阵**
- 交叉表分析
- 支持展开/折叠
- 条件格式

```
技巧：
- 添加小计和总计
- 使用条件格式突出显示
- 启用钻取功能
```

### 瀑布图

- 显示累计效应
- 适用场景：损益分析、预算变化

```
示例：
收入 → 成本 → 利润
期初余额 → 收入 → 支出 → 期末余额
```

### 漏斗图

- 显示流程各阶段的转化
- 适用场景：销售漏斗、转化率分析

### 丝带图

- 显示排名随时间的变化
- 适用场景：市场份额变化、竞争分析

## 条件格式

### 数据条

```
使用场景：
- 表格中快速比较数值
- 突出显示相对大小
```

### 颜色刻度

```
配色方案：
- 单色：表示强度（浅→深）
- 双色：表示正负（红→绿）
- 三色：表示范围（低→中→高）
```

### 图标

```
常用图标：
✓ / ✗ - 达标与否
↑ / → / ↓ - 趋势方向
● - 状态指示器
```

### 规则示例

```dax
// 颜色规则（度量值）
Sales Color = 
SWITCH(
    TRUE(),
    [Total Sales] > [Target] * 1.1, "#00FF00",  // 绿色
    [Total Sales] > [Target] * 0.9, "#FFFF00",  // 黄色
    "#FF0000"  // 红色
)
```

## 交互性

### 切片器

```
类型：
- 列表
- 下拉列表
- 日期范围
- 相对日期
- 数值范围
```

**切片器最佳实践：**
- 放在显眼位置
- 使用清晰的标签
- 配置交互行为
- 同步多页切片器

### 钻取

**向下钻取**
```
层次结构示例：
年份 → 季度 → 月份 → 日
国家 → 省份 → 城市
```

**穿透钻取**
- 跳转到详细报告页
- 传递筛选上下文

### 工具提示

**默认工具提示**
- 显示字段值
- 自动生成

**报表页工具提示**
- 自定义工具提示内容
- 显示详细分析
- 添加可视化

```
创建步骤：
1. 创建新报表页
2. 设置页面大小为"工具提示"
3. 添加可视化
4. 在其他页面的视觉对象中引用
```

## 设计原则

### 布局设计

```
F 型布局：
- 顶部：关键 KPI
- 左侧：导航和筛选器
- 中间：主要可视化
- 底部：详细信息
```

### 颜色使用

```
颜色指南：
✅ 使用企业品牌色
✅ 保持一致性
✅ 考虑色盲友好
✅ 使用对比色突出重点

❌ 避免过多颜色
❌ 避免霓虹色
❌ 避免纯黑背景
```

### 字体和排版

```
建议：
- 标题：18-24pt
- 正文：10-12pt
- 使用 2-3 种字体
- 保持对齐和间距一致
```

## 性能优化

### 减少视觉对象数量

```
每页建议：
- 视觉对象：< 15 个
- 切片器：< 5 个
```

### 优化数据加载

```
✅ 只导入必要的列
✅ 在 Power Query 中进行筛选
✅ 使用聚合表
✅ 减少高基数列
```

### 使用书签

```
用途：
- 创建导航
- 切换视图
- 讲述数据故事
- 重置筛选器
```

## 移动端优化

### 移动布局

```
设计要点：
- 纵向布局
- 简化视觉对象
- 大号按钮和图标
- 减少文字
```

### 移动特定功能

- 手机纵向视图
- 触摸优化
- 离线访问（Premium）

## 辅助功能

### 无障碍设计

```
最佳实践：
✅ 添加替代文本
✅ 使用高对比度
✅ 支持键盘导航
✅ 提供数据表视图
```

### Tab 键顺序

- 设置逻辑的 Tab 顺序
- 便于键盘用户导航

## 发布和共享

### 发布选项

```
1. Power BI Service
   - 在线查看和共享
   
2. Power BI Report Server
   - 本地部署
   
3. 嵌入
   - 嵌入到网站或应用
```

### 共享权限

```
权限类型：
- 查看者：只能查看
- 参与者：可以编辑
- 管理员：完全控制
```

## 模板和主题

### 自定义主题

```json
{
  "name": "Custom Theme",
  "dataColors": [
    "#1f77b4",
    "#ff7f0e",
    "#2ca02c"
  ],
  "background": "#FFFFFF",
  "foreground": "#000000"
}
```

### 报表模板

- 创建 .pbit 文件
- 包含布局和设计
- 不包含数据

!!! tip "设计建议"
    - 保持简洁：少即是多
    - 讲故事：引导用户理解数据
    - 测试：在不同设备上测试
    - 迭代：根据反馈持续改进

## 学习资源

- [Power BI 可视化最佳实践](https://docs.microsoft.com/en-us/power-bi/visuals/power-bi-visualization-best-practices)
- [Data Viz Project](https://datavizproject.com/) - 图表类型参考
- [Storytelling with Data](https://www.storytellingwithdata.com/)
